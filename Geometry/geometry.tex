\documentclass[12pt]{article} 

%Формат файла
\usepackage[paperheight=297mm,
   paperwidth=210mm,
   top=20mm,
   bottom=20mm,
   left=15mm,
   right=15mm]{geometry}


%Текст
\usepackage[fontsize=12pt]{fontsize}
\usepackage[english, russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{color}
\usepackage{transparent}
\usepackage{amsthm}
\usepackage{multicol}
\parindent=0cm

\theoremstyle{definition}
\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}[theorem]{Лемма}
\newtheorem{definition}{Определение}
\newtheorem{axiom}{Аксиома}
\newtheorem{statement}[theorem]{Утверждение}
\newtheorem{consequence}{Следствие}[subsection]
\renewcommand\qedsymbol{$\blacksquare$}

%Картинки
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{tkz-euclide}
\usepackage{pgfplots}
\usetikzlibrary {arrows.meta}
\usetikzlibrary{calc}
\usetikzlibrary{through}
\usetikzlibrary{intersections}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{positioning}
\usetikzlibrary{3d}
\usetikzlibrary{perspective}

\makeatletter
\tikzoption{canvas is plane}[]{\@setOxy#1}
\def\@setOxy O(#1,#2,#3)x(#4,#5,#6)y(#7,#8,#9)%
  {\def\tikz@plane@origin{\pgfpointxyz{#1}{#2}{#3}}%
   \def\tikz@plane@x{\pgfpointxyz{#4}{#5}{#6}}%
   \def\tikz@plane@y{\pgfpointxyz{#7}{#8}{#9}}%
   \tikz@canvas@is@plane
  }
\makeatother  


%Математика
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[makeroom]{cancel}

%Всякое
\usepackage{relsize}
\usepackage{enumerate}
\usepackage[inline]{enumitem}
\usepackage{hyperref}

%Мат команды
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand*\diff{\mathop{}\!\mathrm{d}}

%Оглавление
\title{\textbf{Геометрия}}\date{}\author{}

\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\providecommand{\dotdiv}{% Don't redefine it if available
  \mathbin{% We want a binary operation
    \vphantom{+}% The same height as a plus or minus
    \text{% Change size in sub/superscripts
      \mathsurround=0pt % To be on the safe side
      \ooalign{% Superimpose the two symbols
        \noalign{\kern-.25ex}% but the dot is raised a bit
        \hidewidth$\smash{\cdot}$\hidewidth\cr % Dot
        \noalign{\kern.5ex}% Backup for vertical alignment
        $-$\cr % Minus
      }%
    }%
  }%
}

\pgfplotsset{compat=1.18}
\begin{document}

\maketitle
\tableofcontents
\label{toc}
\newpage

\section{Бинарное отношение и векторы}

\begin{definition}
     Пусть множество $a,b \in M$. Множество $R \subset \{(a,b)|a,b\in M\}$ упорядоченных пар. Если $(\widehat{a},\widehat{b})\subset R$, пишут $\widehat{a}\underset{R}{\sim}\widehat{b}.$
\end{definition}

\begin{definition}
    Отношение $\sim$ на $M$ называется:
        \begin{enumerate}
            \item Рефлексивным: $\forall a \in M: a\sim a$
            \item Симметричным: $\forall a,b \in M: a\sim b \Longleftrightarrow b\sim a$
            \item Транзитивным: $\forall a,b \in M: a\sim b, b\sim c \Longrightarrow a \sim c$
        \end{enumerate}
\end{definition}
    
    \begin{definition}
        Отношение $\sim$ на $M$ называется отношением эквивалентности, если оно рефлексивно, симметрично и транзитивно.
    \end{definition}

    Как только на $M$ задано отношение эквивалентности, появляется $M/\sim$ классов эквивалентности.

\begin{definition}
    Вектор -- класс эквивалентности параллельных переносов.
\end{definition}

    Свойства сложения векторов:
    \begin{itemize}
        \item Коммутативно: $\vec{a}+\vec{b}=\vec{b}+\vec{a}$
        \item Ассоциативно: $(\vec{a}+\vec{b})+\vec{c}=\vec{a}+(\vec{b}+\vec{c})$
    \end{itemize}

    \begin{definition}
        $\vec{a}$ коллинеарен $\vec{b}$, если $\exists \lambda \in \R: \lambda\vec{a}=\vec{b}.$
    \end{definition}

\begin{definition}
    Базисом на плоскости называется пара неколлинеарных векторов $(\vec{a};\vec{b}).$
\end{definition}

\begin{theorem}
    $\forall \vec{\textit{v}}\in V_{\R^2} \exists!(x;y);x,y\in \R: \vec{\textit{v}}=x\vec{a}+y\vec{b}$, где $(\vec{a};\vec{b})$ -- базис $V_{\R^2}.$ То есть $(x;y)$ -- координаты $\vec{\textit{v}}$ в базисе $(\vec{a};\vec{b}).$
\end{theorem}

\begin{definition}
    Углом между векторами $\vec{a}$ и $\vec{b}$ называется: $\varphi=\arccos \left( \dfrac{(\vec{a};\vec{b})}{|\vec{a}\parallel\vec{b}|}\right)\Longleftrightarrow \cos \varphi = \dfrac{(\vec{a};\vec{b})}{|\vec{a}\parallel\vec{b}|}$, где $|\vec{a}|=\sqrt{(a,a)}.$
\end{definition}

\begin{theorem}
    $C\in AB \Longleftrightarrow \forall O: \exists \lambda \in \R: \lambda \overrightarrow{OA}+(1-\lambda) \overrightarrow{OB}=\overrightarrow{OC}$
\end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale=0.8]
        \draw (-5,3) -- (5,3);
        \draw (-4.5,3) node[above] {$C$};
        \draw (-1.5,3) node[above] {$A$};
        \draw (4.5,3) node[above] {$B$};
        \draw (1,-1) node[below] {$O$};
        \draw[-{Stealth[scale = 1.5]}] (1,-1) -- node[below left]{$\vec{c}$} ++(-5.5,4);
        \draw[-{Stealth[scale = 1.5]}] (1,-1) -- node[above right]{$\vec{a}$} ++(-2.5,4);
        \draw[-{Stealth[scale = 1.5]}] (1,-1) -- node[below right]{$\vec{b}$} ++(3.5,4);
        \foreach \point in {(-4.5,3), (1,-1), (-1.5,3), (4.5,3)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        Обозначим $\overrightarrow{OA}=\vec{a},\overrightarrow{OB}=\vec{b},\overrightarrow{OC}=\vec{c}$. Тогда $\vec{c}-\vec{b}=\overrightarrow {BC}$; $\vec{a}-\vec{b}=\overrightarrow{BA}$. Тогда обозначим $\dfrac{\mid \vec{c}-\vec{b}\mid }{\mid \vec{a}-\vec{b}\mid }=x$, откуда $\vec{c}-\vec{b}=x(\vec{a}-\vec{b})$, то есть $\vec{c}=x\vec{a}-(1-x)\vec{b}$.
    \end{proof}

\begin{theorem}
    Пусть $O$ и $H$ -- центр описанной окружности и ортоцентр $\triangle ABC$ соответственно. Тогда $\overrightarrow{OH}=\overrightarrow{OA}+\overrightarrow{OB}+\overrightarrow{OC}$.
\end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale=0.75]
        \draw (0,0) circle (4.5);
        \draw (60:4.5) -- (-145:4.5) -- (-35:4.5) -- cycle;
        \draw (60:4.5) node[above right] {$B$};
        \draw (-145:4.5) node[below left] {$A$};
        \draw (-35:4.5) node[below right] {$C$};
        \draw (0,0) node[above left] {$O$};
        \draw[-{Stealth[scale = 1.5]}] (0,0) -- (60:4.5);
        \draw[-{Stealth[scale = 1.5]}] (0,0) -- (-145:4.5);
        \draw[-{Stealth[scale = 1.5]}] (0,0) -- (-35:4.5);
        \draw (0,-5.1621) node[below] {$K$};
        \draw[-{Stealth[scale = 1.5]}, name path = line3] (0,0) -- (0,-5.1621);
        \draw (-145:4.5) -- (0,-5.1621) -- (-35:4.5);
        \draw[draw opacity = 0, name path =line1] ($(-145:4.5)!(-35:4.5)!(60:4.5)$) -- (-35:4.5);
        \draw[name path = line2] ($(-145:4.5)!(60:4.5)!(-35:4.5)$) -- (60:4.5);
        \draw[name intersections={of=line1 and line2}] (intersection-1) node[right] {$H$};
        \coordinate (Hc) at ($(-145:4.5)!(60:4.5)!(-35:4.5)$) {};
        \coordinate (C) at (60:4.5) {};
        \coordinate (A) at (-145:4.5) {};
        \foreach \point in {(60:4.5), (-145:4.5), (0,0), (-35:4.5), (0,-5.1621), (intersection-1)}{
    \fill \point circle (1.8pt);
}
        \draw[-{Stealth[scale = 1.5]}] (0,0) -- (intersection-1);
        \tkzMarkRightAngle(C,Hc,A);
        \end{tikzpicture}
    \end{center}
        Рассмотрим сумму $\overrightarrow{OA}+\overrightarrow{OC}=\overrightarrow{OK}$, $|\overrightarrow{OA}|=|\overrightarrow{OC}|$, как радиусы описанной окружности, следовательно, $AOCK$ -- ромб, а значит $AC\perp OK$ как диагонали. Тогда $OK\parallel BH$, а значит точка $M$ вектора $\overrightarrow{OM}=\overrightarrow{OK}+\overrightarrow{OB}$ лежит на $BH$, но аналогично эта точка лежит на всех высотах $\triangle ABC$, а значит является ортоцентром.
    \end{proof}

\begin{theorem}
    Пусть $\overrightarrow{OK}$ и $\overrightarrow{OL}$ -- базис в $\triangle ABC$, а $M$ -- его центроид. Тогда $\overrightarrow{OM}=\dfrac{1}{3}(\overrightarrow{OA}+\overrightarrow{OB}+\overrightarrow{OC})$.
\end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
            \coordinate (A) at (-4,-1) {};
            \coordinate (B) at (-0.5,1.5) {};
            \coordinate (C) at (0.5,-3) {};
            \coordinate (O) at (3,-1.5) {};
            \coordinate (Mb) at ($(A)!0.5!(C)$);
            \coordinate (Mc) at ($(A)!0.5!(B)$);
            \draw (A)--(B)--(C)--cycle;
            \draw[-{Stealth[scale = 1.5]}] (O)--(A);
            \draw[-{Stealth[scale = 1.5]}] (O)--(B);
            \draw[-{Stealth[scale = 1.5]}] (O)--(C);
            \draw[name path = B--Mb, draw opacity = 0] (B)--(Mb);
            \draw[name path = C--Mc, draw opacity = 0] (C)--(Mc);
            \draw[name intersections={of=B--Mb and C--Mc}] (intersection-1) node[above] {$M$};
            \draw[-{Stealth[scale = 1.5]}] (O)--(intersection-1);
            \draw (A) node[left] {$A$};
            \draw (B) node[above] {$B$};
            \draw (C) node[below] {$C$};
            \draw (O) node[right] {$O$};
            \foreach \point in {(A), (B), (C), (O), (intersection-1)}{
    \fill \point circle (1.8pt);
}
            \tkzLabelSegment[above right](O,B){$\vec{b}$};
            \tkzLabelSegment[below left](O,A){$\vec{a}$};
            \tkzLabelSegment[below right](O,C){$\vec{c}$};
            \tkzLabelSegment[above](O,intersection-1){$\vec{m}$};
        \end{tikzpicture}
    \end{center}
        Обозначим $\overrightarrow{OA}$ как $\vec{a}$, $\overrightarrow{OB}$ как $\vec{b}$, $\overrightarrow{OC}$ как $\vec{c}$, $\overrightarrow{OM}$ как $\vec{m}$. Представим $\overrightarrow{OM}$ в виде суммы векторов: $\vec{b}+\overrightarrow{BM}=\vec{b}+\dfrac{2}{3}\left( \dfrac{\overrightarrow{BA}+\overrightarrow{BC}}{2}\right)=\vec{b}+\dfrac{1}{3}\overrightarrow{BA}+\dfrac{1}{3}\overrightarrow{BC}=\vec{b}+\dfrac{1}{3}(\vec{a}-\vec{b})+\dfrac{1}{3}(\vec{c}-\vec{b})=\dfrac{1}{3}(\vec{a}+\vec{b}+\vec{c})$.
    \end{proof}

\begin{theorem}
    Пусть $O$ -- центр описанной окружности, $H$ -- ортоцентр, а $M$ -- центроид $\triangle ABC$ соответственно. Тогда $O$, $H$ и $M$ -- коллинеарны.
\end{theorem}

    \begin{proof}
        Из предыдущих двух теорем нам известно, что $\overrightarrow{OH}=\overrightarrow{OA}+\overrightarrow{OB}+\overrightarrow{OC}$, а также что $\overrightarrow{OM}=\dfrac{1}{3}(\overrightarrow{OA}+\overrightarrow{OB}+\overrightarrow{OC})$, из чего следует, что $\overrightarrow{OH}=3\overrightarrow{OM}$.
    \end{proof}

\begin{definition}
    Скалярным произведением векторов $\vec{a}$ и $\vec{b}$ называется величина $|\vec{a}|\cdot |\vec{b}|\cdot \cos \varphi$, где $\varphi$ -- угол между векторами $\vec{a}$ и $\vec{b}$.
\end{definition}

\begin{theorem}
    В прямоугольной системе Декарта скалярное произведение двух векторов\\ $\vec{a}(x_1;y_1)$ и $\vec{b}(x_2;y_2)$ равно сумме произведений их соответствующих координат: 
    $$\vec{a}\cdot \vec{b}=x_1\cdot x_2 + y_1\cdot y_2$$
\end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
            \draw[-{Stealth[scale = 1.5]}] (-.5,0) -- (6.5,0) node[below] {$x$};
            \draw[-{Stealth[scale = 1.5]}] (0,-.5) -- (0, 4.5) node[left] {$y$};
            \draw node[below left] {$O$};
            \coordinate (A) at (2,3.5) {};
            \coordinate (B) at (4,2) {};
            \coordinate (O) at (0,0) {};
            \draw (A) node[above] {$A(x_1;y_1)$};
            \draw (B) node[below right] {$B(x_2;y_2)$};
            \draw[-{Stealth[scale = 1.5]}] (O) -- (A);
            \draw[-{Stealth[scale = 1.5]}] (O) -- (B);
            \draw[-{Stealth[scale = 1.5]}] (A) -- (B);
            \tkzLabelSegment[above left](O,A){$\vec{a}$};
            \tkzLabelSegment[below right](O,B){$\vec{b}$};
            \tkzMarkAngle[size=.65cm](B,O,A);
            \tkzLabelAngle(B,O,A){$\varphi$};
            \foreach \point in {(A), (B), (O)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        По теореме косинусов $AB^2=OA^2+OB^2-2\cdot OA\cdot OB \cdot \cos \varphi$, но по теореме Пифагора $OA^2=(x_1)^2+(y_1)^2$, $OB^2=(x_2)^2+(y_2)^2$, $AB^2=(x_1-x_2)^2+(y_1-y_2)^2$. Тогда если подставить в первое выражение и упростить получим $x_1\cdot x_2 + y_1\cdot y_2=OA\cdot OB\cdot \cos \varphi$.
    \end{proof}

    \section{Метод координат}

    \begin{definition}
        Общим уравнением прямой называется уравнение вида $ax+by+c=0$, в котором $a$ и $b$ не равны нулю:

        \begin{align*}
            &l_1:a_1x+b_1y+c_1=0\\
            &l_2:a_2x+b_2y+c_2=0\\
            &l_1\parallel l_2 \overset{b_1\cdot b_2\neq 0}{\Longleftrightarrow} \frac{-a_1}{b_1}=\frac{-a_2}{b_2}\Longleftrightarrow a_1b_2=a_2b_1\\
            &l_1\perp l_2 \overset{b_1\cdot b_2\neq 0}{\Longleftrightarrow} \frac{-a_1}{b_1}\cdot \frac{-a_2}{b_2}=-1 \Longleftrightarrow a_1a_2+b_1b_2=0
        \end{align*}
    \end{definition}

    \subsection{Нормаль и направляющий вектор}

    \begin{definition}
        Вектор $\vec{\textit{v}}$ называется направляющим для прямой $l$, если его начало и конец лежат на $l$.
    \end{definition}

    \begin{definition}
        Любой вектор $\vec{n_l}:\, \vec{n_l}\perp l$, называется ее нормалью.
    \end{definition}

    \begin{theorem}
        Вектор $\vec{n}(a;b)$ является вектором нормали к прямой $l$, заданной уравнением $ax+by+c=0$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
        \draw[-{Stealth[scale = 1.5]}] (-2,0) -- (7,0) node[below]{$x$};
        \draw[-{Stealth[scale = 1.5]}] (0,-1) -- (0,4.6) node[left]{$y$};
        \draw (-2,4) -- (7,-1);
        \draw ($(-2,4)!0.1!(7,-1)$) node[above right]{$l$};
        \coordinate (A) at ($(-2,4)!0.65!(7,-1)$) {};
        \coordinate (B) at ($(-2,4)!0.3!(7,-1)$) {};
        \coordinate (C) at (5.37,3.5) {};
        \draw (A) node[below left] {$A$};
        \draw (B) node[below left] {$B$};
        \draw (0,0) node[below left] {$O$};
        \draw[-{Stealth[scale = 1.5]}] ($(A)!(C)!(B)$) -- (C) node[right]{$\vec{n}$};
        \draw[-{Stealth[scale = 1.5]}] (A) -- (B);
        \foreach \point in {(A), (B), (O)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        Возьмем произвольные точки $A(x_1;y_1)$ и $B(x_2;y_2)$. Тогда $\overrightarrow{AB}(x_2-x_1;y_2-y_1)$. При этом $ax_1+by_1+c=ax_2+by_2+c=0$, следовательно, если вычесть одно из другого, получим $a(x_2-x_1)+b(y_2-y_1)=0$. Рассмотрим $\overrightarrow{AB}\cdot \vec{n} = a\cdot(x_2-x_1)+b\cdot(y_2-y_1)=0\Longrightarrow \overrightarrow{AB}\perp \vec{n}$.
    \end{proof}

    \subsection{Расстояние от точки до прямой}

    \begin{theorem}
        $\rho(A;l):\, A(x_0;y_0), \, l:\, ax+by+c=0: \, \rho(A;l)=
        \dfrac{|ax_0+by_0+c|}{\sqrt{a^2+b^2}}$
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
            \draw[-{Stealth[scale = 1.5]}] (-0.5,0) -- (6,0) node[below]{$x$};
            \draw[-{Stealth[scale = 1.5]}] (0,-0.5) -- (0,8) node[left]{$y$};
            \draw (0,0) node[below left] {$O$};
            \begin{scope}
                \clip (-0.5,-0.5) rectangle (6,8);
                \draw[domain=-0.5:6, variable=\x, samples=50] plot ({\x},{-(\x)+4.5});
            \end{scope}
            \coordinate (B) at (0,4.5) {};
            \coordinate (C) at (4.5,0) {};
            \coordinate (O) at (0,0) {};
            \coordinate (A) at (4,3) {};
            \draw (A) node[above right]{$A(x_0;y_0)$};
            \tkzMarkAngle[size=.65cm](B,C,O);
            \tkzLabelAngle(B,C,O){$\alpha$};
            \begin{scope}
                \clip (-0.5,-0.5) rectangle (6,8);
                \draw[domain=-0.5:6, variable=\x, samples=50] plot ({\x},{-(\x)+7});
            \end{scope}
            \draw (0,7) node[scale=.8,below left]{$\dfrac{f-c}{b}$};
            \draw (0,4.5) node[scale=.8,below left]{$-\dfrac{c}{b}$};
            \draw (0,5.5) node[scale=.8,right]{$\dfrac{|f|}{b}$};
            \coordinate (D) at ($(B)!(A)!(C)$) {};
            \coordinate (E) at ($(D)+(0,2.5)$) {}; 
            \draw (D) -- (A);
            \draw (D) -- (E);
            \draw (D) ++(0,1.75) node[scale=.8,left]{$\dfrac{|f|}{b}$};
            \tkzMarkRightAngle(A,D,C);
            \tkzMarkAngle[size=.65cm](A,D,E);
            \tkzLabelAngle(A,D,E){$\alpha$};
            \draw (4,1) node[above left]{$l$};
            \foreach \point in {(A), (B), (C), (D), (E), (0,7), (O)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть $A(x_0;y_0)$, тогда $ax_0+by_0+c=f\Longrightarrow y_0=\dfrac{f-c}{b}-\dfrac{ax_0}{b}$. Проведем через точку $A$ перпендикуляр к $l$, а также прямую, параллельную $l$. Отметим найденные ранее координаты на $OY$, а также найдем расстояние между ними. Пусть угол наклона $l$ относительно $OX$ равен $\alpha$, тогда $\tg \alpha = -\dfrac{a}{b}$. Из основного тригонометрического тождества:
        \setlength{\tabcolsep}{1em}
        \def\arraystretch{1.5}
        \begin{center}
            \begin{tabular}{cc}
                $\sin^2\alpha+\cos^2\alpha=1$ & $\cos^2\alpha=\dfrac{1}{\frac{a^2}{b^2}+1}$\\
                $\tg^2\alpha+1=\dfrac{1}{\cos^2\alpha}$ & $\cos \alpha = \dfrac{b}{\sqrt{a^2+b^2}}$
            \end{tabular}
        \end{center}
    Тогда, чтобы найти $\rho(A;l)$, умножим косинус на гипотенузу и получим: 
    $$\dfrac{b}{\sqrt{a^2+b^2}} \cdot \dfrac{|f|}{b}=\dfrac{|ax_0+by_0+c|}{\sqrt{a^2+b^2}}$$ 
    \end{proof}

    \section{Кривые второго порядка}
    \subsection{Свойства кривых второго порядка}

    \begin{definition}
        Углом между кривыми называется угол между их касательными в данной точке.
    \end{definition}

    \begin{definition}
        Эллипсом называется ГМТ, сумма расстояний от которых до двух фиксированных точек, называющихся фокусами, постоянна.
    \end{definition}

    \begin{center}
        \begin{tikzpicture}
          \def\a{4}
          \def\b{2}
          \draw (0,0) ellipse ({\a} and {\b});
          \draw (-\a,0) coordinate (A) -- (\a,0) coordinate (B);
          \draw (0,-\b) coordinate (D) -- (0,\b) coordinate (C);
          \coordinate (O) at (0,0);
          \coordinate (F1) at ({-sqrt(\a*\a-\b*\b)},0);
          \coordinate (F2) at ({+sqrt(\a*\a-\b*\b)},0);
          \draw (F1) node[below right] {$F_1$};
          \draw (F2) node[below left] {$F_2$};
          \tkzLabelSegment[right](O,C){$b$};
          \tkzLabelSegment[above](O,A){$a$};
          \node[align=left] at ({\a*2},0) {
              $F_1,\, F_2$ -- фокусы эллипса\\
              $a$ -- большая ось
              \\$b$ -- малая ось
          };
          \foreach \point in {(F1), (F2)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}

    \begin{definition}
        Параболой называется ГМТ, равноудаленных от фиксированной точки $F$, называемой ее фокусом, и прямой $l$, называемой директрисой данной параболы.
    \end{definition}

    \begin{center}
        \begin{tikzpicture}
            \begin{scope}
                \clip (-3,-1) rectangle (3,4);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(\x)^2});
            \end{scope}
            \coordinate (F) at (0,0.25);
            \draw (F) node[above left]{$F$};
            \draw ($(0,-1)!0.9!(0,4)$) node[left]{$l\, '$};
            \draw ($(-3,-.25)!0.1!(3,-.25)$) node[below]{$l$};
            \draw (0,-1) -- (0,4);
            \coordinate (A) at (1.5,{1.5^2});
            \draw (A) node[below right]{$A$};
            \coordinate (B) at (1.5,-0.25);
            \coordinate (C) at (2,-0.25);
            \draw (B) -- (A) -- (F);
            \tkzMarkSegment[mark=||](F,A);
            \tkzMarkSegment[mark=||](A,B);
            \tkzMarkRightAngle(A,B,C);
            \node[align=left] at (7,1.5) {
              $l\, '$ -- ось параболы\\
              $F$ -- фокус параболы\\
              $l$ -- директриса параболы
          };
          \foreach \point in {(F), (A), (B)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}

    \begin{definition}
        Гиперболой называется ГМТ, модуль разности расстояний от которых до двух фиксированных точек, называемых фокусами, постоянен.
    \end{definition}

    \begin{center}
        \begin{tikzpicture}
            \begin{scope}
             \clip (-2.5,-2.5) rectangle (2.5,2.5);
                \draw plot[variable=\t,samples=100,domain=-3:3] ({-1*cosh(\t)},{1*sinh(\t)});
                \draw plot[variable=\t,samples=100,domain=-3:3] ({1*cosh(\t)},{1*sinh(\t)});
                \draw plot[variable=\t,samples=100,domain=-3:3] (\t, \t);
                \draw plot[variable=\t,samples=100,domain=-3:3] (\t, {-\t});
            \end{scope}
            \draw ($(-2.5,-2.5)!0.1!(2.5,2.5)$) node[below right]{$l$};
            \draw ($(-2.5,2.5)!0.1!(2.5,-2.5)$) node[above right]{$l\, '$};
            \coordinate (F1) at ({-sqrt(2)},0);
            \draw (F1) node[above] {$F_1$};
            \coordinate (F2) at ({sqrt(2)},0);
            \draw (F2) node[above] {$F_2$};
            \node[align=left] at (6.5,0){
                $F_1,\, F_2$ -- фокусы гиперболы\\
                $l,\, l\, '$ -- асимптоты гиперболы
            };
            \foreach \point in {(F1), (F2)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
    
    \begin{theorem}[Оптическое свойство эллипса]
        Пусть $l$ касается эллипса с фокусами $F_1$ и $F_2$ в точке $P$, тогда $l$ -- биссектриса угла, смежного $\angle F_1PF_2$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
        \def\a{3}
        \def\b{1.5}
        \def\q{-4}
        \def\x{{\a^2/\q}}
        \def\y{{\b*sqrt(1-(\a/\q)^2)}}
        \coordinate (O) at (0,0);
        \coordinate (Y) at (\q,0);
        \coordinate (P) at (\x,\y);
        \coordinate (F1) at ({-sqrt(\a*\a-\b*\b)},0);
        \coordinate (F2) at ({+sqrt(\a*\a-\b*\b)},0);
        \coordinate (Z) at ($(F1)!1.5!(P)$);
        \coordinate (X) at ($(Y)!2!(P)$);
        \draw (O) ellipse ({\a} and {\b});
        \draw ($(Y)!-0.5!(P)$) -- ($(Y)!2.5!(P)$);
        \draw (Y) node[above left]{$Y$};
        \draw (X) node[above left]{$X$};
        \draw (P) node[above left]{$P$};
        \draw (F1) node[below right]{$F_1$};
        \draw (F2) node[below left]{$F_2$};
        \draw (F1) -- ($(F1)!1.7!(P)$);
        \draw (F2) -- ($(F2)!1.2!(P)$);
        \tkzMarkAngle[size=.65cm, mark=|](Y,P,F1);
        \tkzMarkAngle[size=.65cm, mark=|](F2,P,X);
        \tkzMarkAngle[size=.65cm,mark=|](X,P,Z);
        \foreach \point in {(F1), (F2), (Y), (P), (X)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть $X, \, Y \in l$, тогда по определению касательной $XF_1+XF_2\geq PF_1 + PF_2$. Следовательно, $P$ -- точка на $l$, сумма расстояний от которой до фокусов минимальна, откуда $\angle F_2PX=\angle F_1PY$.
    \end{proof}

    \begin{theorem}[Оптическое свойство параболы]
        Пусть $l$ касается параболы в точке $P$, $P\,'$ -- проекция точки $P$ на директрису. Тогда $l$ -- биссектриса $\angle FPP\,'$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale = 2.6]
            \begin{scope}
                \clip (-1.3,-0.5) rectangle (1.3,1.5);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot (\x, {-2*\x-1});
            \end{scope}
            \coordinate (P) at (-1,1);
            \coordinate (T) at (-0.7,0.49);
            \coordinate (P') at (-1,-0.25);
            \coordinate (T') at (-0.7,-0.25);
            \coordinate (F) at (0,0.25);
            \draw (P) node[below left] {$P$};
            \draw (P') node[below] {$P\,'$};
            \draw (T) node[above right] {$T$};
            \draw (T') node[below] {$T\,'$};
            \draw (F) node[above right] {$F$};
            \draw (P') -- (P) -- (F);
            \draw (T) -- (T') -- (F);
            \draw (P') -- (T) -- (F);
            \tkzMarkSegment[mark=|](P,P');
            \tkzMarkSegment[mark=|](P,F);
            \tkzMarkSegment[mark=||](P',T);
            \tkzMarkSegment[mark=||](T,F);
            \tkzMarkAngle[size=.3cm,mark=|](P',P,T);
            \tkzMarkAngle[size=.3cm,mark=|](T,P,F);
            \foreach \point in {(F), (P), (P'), (T), (T')}{
    \fill \point circle (.6pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть биссектриса не касается параболы, то есть пересекает ее в точке $T$. По определению параболы $PP\,'=PF\Longrightarrow \triangle P\,'PT=\triangle PFT$ по двум сторонам и углу между ними. Отсюда $P\,'T=TF$, но тогда если $T\,'$ -- проекция $T$ на директрису, то $TT\,'=TF$, то есть $TP\,'=TT\,'$, противоречие.
    \end{proof}

    \begin{theorem}[Оптическое свойство гиперболы]
        Пусть $l$ касается гиперболы с фокусами $F_1$ и $F_2$ в точке $P$, тогда $l$ -- биссектриса $\angle F_1F_2P$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale = 1.5]
        \begin{scope}
            \clip (-2,-2) rectangle (2,2);
            \begin{scope}[rotate=-45]
                \clip (-5,-5) rectangle (5,5);
                \draw plot[variable=\t,samples=100,domain=-5:-0.001] (\t,{1/(\t*2)});
                \draw plot[variable=\t,samples=100,domain=0.001:5] (\t,{1/(\t*2)});
                \draw plot[variable=\t,samples=100,domain=0.001:5] (\t,-12.5*\t+5);
                \coordinate (P) at (0.2,2.5);
                \coordinate (F1) at (-1,-1);
                \coordinate (F2) at (1,1);
                \coordinate (t) at (1,-7.5);
                \coordinate (T) at ($(t)!(F2)!(P)$);
                \coordinate (F2') at ($(F2)!2!(T)$);
                \draw (P) node[above left] {$P$};
                \draw (F1) node[below left] {$F_1$};
                \draw (F2) node[below right] {$F_2$};
                \draw (F2') node[above left] {$F_2\,'$};
                \draw (T) node[above] {$T$};
                \draw (F1) -- (P) -- (F2);
                \draw (F1) -- (T);
                \tkzMarkAngle[size=.65cm, mark=|](F1,P,t);
                \tkzMarkAngle[size=.65cm, mark=|](t,P,F2);
                \tkzMarkSegment[mark=||](F2,T);
                \tkzMarkSegment[mark=||](T,F2');
                \draw (F2) -- (F2');
                \foreach \point in {(P), (F1), (F2), (F2'), (T)}{
    \fill \point circle (1.2pt);
}
            \end{scope}
        \end{scope}   
        \end{tikzpicture}
    \end{center}
        Пусть биссектриса не касается гиперболы, то есть пересекает ее в точке $T$. Обозначим через $F_2\,'$ точку, симметричную $F_2$ относительно $l$. Тогда $F_2T=F_2\,'T$, а также $F_2P=F_2\,'P$. Кроме того, $F_1$, $F_2\,'$ и $P$ коллинеарны по определению биссектрисы. По определению гиперболы $F_1P-F_2P=F_1T-F_2T$. Тогда получаем, что $F_1F_2\,'=F_1P-F_2\,'P=F_1T-F_2\,'T$, но по неравенству треугольника $F_1F_2\,'>F_1T-F_2\,'T$, противоречие.
    \end{proof}

    \begin{theorem}[Изогональное свойство эллипса]
        Пусть $PX$ и $PY$ -- касательные к эллипсу с фокусами $F_1$ и $F_2$. Тогда $\angle F_1PX=\angle F_2PY$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}
        \def\a{4}
        \def\b{2}
        \draw (0,0) ellipse ({\a} and {\b});
        \coordinate (F1) at ({-sqrt(\a*\a-\b*\b)},0) {};
        \coordinate (F2) at ({+sqrt(\a*\a-\b*\b)},0) {};
        \coordinate (O) at (0,0);
        \coordinate (X) at (135:{\a} and {\b}) {};
        \coordinate (Y) at (35:{\a} and {\b}) {};
        \tkzDefLine[bisector out](F1,X,F2) \tkzGetPoint{K}
        \tkzDefLine[bisector out](F1,Y,F2) \tkzGetPoint{L}
        \draw[draw opacity = 0, name path = line1] ($(K)!-3!(X)$)--($(X)!-1.5!(K)$);
        \draw[draw opacity = 0, name path = line2] ($(L)!0.7!(Y)$)--($(Y)!-0.7!(L)$);
        \draw[name intersections={of=line1 and line2}] (intersection-1) node[above] {$P$};
        \coordinate (P) at (intersection-1);
        \draw (P)--($(X)!-1.5!(K)$);
        \draw ($(L)!0.7!(Y)$)--(P);
        \draw (X) node[above] {$X$};
        \draw (Y) node[above] {$Y$};
        \draw (F1) node[below right] {$F_1$};
        \draw (F2) node[below left] {$F_2$};
        \coordinate (H) at ($(P)!(F1)!(X)$);
        \coordinate (F1') at ($(F1)!2!(H)$);
        \draw (F1') node[above left] {$F_1\,'$};
        \coordinate (H') at ($(P)!(F2)!(Y)$);
        \coordinate (F2') at ($(F2)!2!(H')$);
        \draw (F2') node[above right] {$F_2\,'$};
        \draw (F1') -- (P) -- (F2');
        \draw (F1) -- (P) -- (F2);
        \draw[dashed] (X) -- (F1) -- (F2');
        \draw[dashed] (Y) -- (F2) -- (F1');
        \tkzMarkAngle[size=.65cm](F1',P,X);
        \tkzMarkAngle[size=.85cm](X,P,F1);
        \tkzMarkAngle[size=.85cm](F2,P,Y);
        \tkzMarkAngle[size=.65cm](Y,P,F2');
        \tkzMarkSegment[mark=||](P,F1');
        \tkzMarkSegment[mark=||](P,F1);
        \tkzMarkSegment[mark=|](P,F2');
        \tkzMarkSegment[mark=|](P,F2);
        \foreach \point in {(F1), (P), (X), (Y), (F2), (F1'), (F2')}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть $F_1\,'$ и $F_2\,'$ -- точки, симметричные $F_1$ и $F_2$ относительно $PX$ и $PY$ соответственно. Тогда $PF_1=PF_1\,'$ и $PF_2=PF_2\,'$, при этом $F_1$, $Y$ и $F_2\,'$, а также $F_2$, $X$ и $F_1\,'$ коллинеарны по оптическому свойству эллипса. Получаем, что $F_2F_1\,'=F_2X+XF_1=F_2Y+YF_1=F_1F_2\,'$. То есть $\triangle F_1PF_2\,'=\triangle F_2PF_1\,'$ по трем сторонам. Тогда $\angle F_1PF_2+2\angle F_1PX=\angle F_2PF_1\,'=\angle F_1PF_2\,'=\angle F_1PF_2+2\angle F_2PY\Longrightarrow \angle F_1PX=\angle F_2PY$.
    \end{proof}
    \begin{theorem}
        В обозначениях теоремы 3.4 прямая $F_1P$ суть биссектриса $\angle XF_1Y$.
    \end{theorem}
    \begin{proof}
        В силу оптических свойств $\angle PF_1\,'X=\angle PF_1X$, при этом из теоремы 3.4 известно, что $\angle PF_1\,'F_2=\angle PF_1F_2\,'$, так как $\triangle F_1PF_2\,'=\triangle F_1\,'PF_2$. Тогда $\angle PF_1F_2\,'=\angle PF_1\,'X=\angle PF_1X$.
    \end{proof}
    \begin{theorem}
        Геометрическим местом точек, из которых данный эллипс виден под прямым углом, является окружность с центром в центре эллипса.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale = 0.7]
        \def\a{2}
          \def\b{4}
          \def\ang{27}
          \def\q{\a/sin(\ang)}
        \begin{scope}
            \clip (-{\q},-{\q}) rectangle ({\q},{\q});
            \begin{scope}[rotate=90]
              \coordinate (O) at (0,0);
              \coordinate (P) at ({\q},0);
              \coordinate (X) at (90-\ang:{\a} and {\b});
              \coordinate (Y) at (270+\ang:{\a} and {\b});
              \draw (O) circle({\q});
              \draw (O) ellipse({\a} and {\b});
              \draw ($(P)!-0.2!(X)$) -- ($(P)!1.2!(X)$);
              \draw ($(P)!-0.2!(Y)$) -- ($(P)!1.2!(Y)$);
            \end{scope}
        \end{scope}
        \coordinate (F1) at ({-sqrt(\b*\b-\a*\a)},0) {};
        \coordinate (F2) at ({+sqrt(\b*\b-\a*\a)},0) {};
        \draw (P) node[above] {$P$};
        \draw (X) node[above] {$X$};
        \draw (Y) node[above right] {$Y$};
        \draw (F1) node[below right] {$F_1$};
        \draw (F2) node[below left] {$F_2$};
        \coordinate (H) at ($(P)!(F1)!(X)$);
        \coordinate (F1') at ($(F1)!2!(H)$);
        \draw (F1') node[above left] {$F_1\,'$};
        \tkzMarkRightAngle(X,P,Y);
        \draw (F2) -- (F1') -- (P) -- cycle;
        \draw (F1) -- (X);
        \tkzMarkSegment[mark=|](F1,X);
        \tkzMarkSegment[mark=|](F1',X);
        \foreach \point in {(F1), (P), (X), (Y), (F2), (F1')}{
    \fill \point circle (2.25pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть $F_1\,'$ -- образ $F_1$ относительно прямой $PX$. Из теоремы 3.4 следует, что $\angle F_1\,'PF_2=\angle XPY=90^{\circ}$. По теореме Пифагора $F_1\,'P^2+F_2P^2=F_1\,'F_2\,^2$, то есть получаем уравнение окружности с центром в середине $F_1F_2$.
    \end{proof}
\subsection{Свойства параболы}
    \begin{lemma}
        Если фокус параболы отразить относительно касательной, то его образ попадет на директрису. Получившаяся точка будет проекцией точки, в которой касательная касается параболы.
    \end{lemma}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[scale = 2.3]
            \begin{scope}
                \clip (-1.5,-0.5) rectangle (1.5,2);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot (\x, {2*\x-1});
            \end{scope}
            \coordinate (P) at (1,1);
            \coordinate (P') at (1,-0.25);
            \coordinate (F) at (0,0.25);
            \coordinate (H) at ($(F)!0.5!(P')$);
            \draw (F) -- (P) -- (P');
            \draw[dashed] (F) -- (P');
            \tkzMarkSegment[mark=|](F,P);
            \tkzMarkSegment[mark=|](P',P);
            \tkzMarkAngle[size=.35cm](F,P,H);
            \tkzMarkAngle[size=.4cm](H,P,P');
            \draw (1.3, 1.69) node[below right] {$l$};
            \draw (F) node[above left] {$F$};
            \draw (P) node[right] {$P$};
            \draw (P') node[below] {$P\,'$};
            \foreach \point in {(F), (P), (P'), (H)}{
    \fill \point circle (0.72pt);
}
        \end{tikzpicture}
    \end{center}
        Пусть прямая $l$ касается параболы в точке $P$, $P\,'$ -- проекция $P$ на директрису параболы. $l$ -- биссектриса $\angle FPP\,'$, но $\triangle FPP\,'$ -- равнобедренный по определению параболы, а значит $l$ в нем медиана и высота, откуда $P\,'$ -- образ $F$.
    \end{proof}
    \setcounter{subsection}{7}
    \begin{consequence}
        Проекции фокуса параболы на его касательные лежат на прямой, касающейся параболы в ее вершине.
    \end{consequence}
    \begin{lemma}
        Пусть $PX$ и $PY$ -- касательные к параболе. Тогда $P$ является центром описанной около $\triangle FX\,'Y\,'$ окружности, где $X\,'$ и $Y\,'$ -- проекции $X$ и $Y$ на директрису параболы соответственно.
    \end{lemma}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale = 4]
            \begin{scope}
                \clip (-1,-.6) rectangle (1,1);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1.06*\x-.28)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(.707*\x-.125)});
            \end{scope}
            \coordinate (X) at (-.52,.27);
            \coordinate (Y) at (.35,.1225);
            \coordinate (X') at (-.52,-.25);
            \coordinate (Y') at (.35,-.25);
            \coordinate (F) at (0,0.25);
            \draw (X) node[below left] {$X$};
            \draw (Y) node[below right] {$Y$};
            \draw (X') node[below left] {$X\,'$};
            \draw (Y') node[below right] {$Y\,'$};
            \draw (F) node[above right] {$F$};
            \tkzDefCircle[circum](F,X',Y')
            \tkzGetPoint{P} \tkzGetLength{rayon}
            \draw (P) circle(\rayon);
            \draw (P) node[above] {$P$};
            \draw[dashed] (X) -- (X');
            \draw[dashed] (Y) -- (Y');
            \tkzMarkRightAngle[scale=.5](X,X',Y');
            \tkzMarkRightAngle[scale=.5](Y,Y',X');
            \foreach \point in {(F), (X), (Y), (X'), (Y'), (P)}{
    \fill \point circle (0.4pt);
}
        \end{tikzpicture}
        \end{center}
        Из леммы 3.8 следует, что $PX$ и $PY$ являются серединными перпендикулярами к $FX\,'$ и $FY\,'$ соответственно. Тогда их точка пересечения будет являться центром окружности, описанной около $\triangle FX\,'Y\,'$.
    \end{proof}
    \setcounter{subsection}{8}
    \setcounter{consequence}{0}
    \begin{consequence}
        Если $PX$ и $PY$ -- касательные к параболе, то $P\,'$ будет серединой $X\,'Y\,'$, где $P\,'$, $X\,'$ и $Y\,'$ -- проекции $P$, $X$ и $Y$ на директрису параболы соответственно.
    \end{consequence}

    \begin{theorem}
        Множество таких точек $P$, из которых парабола видна под прямым углом, суть директриса этой параболы. Кроме того, если $PX$ и $PY$ – касательные к этой параболе, то $XY$ содержит $F$ и $PF$ – высота $\triangle PXY$.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale = 4.5]
            \begin{scope}
                \clip (-1,-.6) rectangle (1,0.7);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-.8*\x-.16)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(1.27*\x-.4)});
            \end{scope}
            \coordinate (X) at (-.4,.16);
            \coordinate (Y) at (.66,.44);
            \coordinate (X') at (-.4,-.25);
            \coordinate (Y') at (.66,-.25);
            \coordinate (F) at (0,0.265);
            \draw (X) node[below left] {$X$};
            \draw (Y) node[below right] {$Y$};
            \draw (X') node[below left] {$X\,'$};
            \draw (Y') node[below right] {$Y\,'$};
            \draw (F) node[above] {$F$};
            \tkzDefCircle[circum](F,X',Y')
            \tkzGetPoint{P} \tkzGetLength{rayon}
            \draw (P) node[below] {$P$};
            \draw[dashed] (X) -- (X');
            \draw[dashed] (Y) -- (Y');
            \draw (X) -- (Y);
            \draw (F) -- (P);
            \tkzMarkRightAngle[scale=.5](X,F,P);
            \tkzMarkRightAngle[scale=.5](X,X',Y');
            \tkzMarkRightAngle[scale=.5](Y,Y',X');
            \tkzMarkAngle[size=.15cm](X,P,X');
            \tkzMarkAngle[size=.18cm](F,P,X);
            \tkzMarkAngle[size=.15cm, mark=|](Y,P,F);
            \tkzMarkAngle[size=.18cm, mark=|](Y',P,Y);
            \tkzMarkSegment[mark=|](X,X');
            \tkzMarkSegment[mark=|](F,X);
            \tkzMarkSegment[mark=||](F,Y);
            \tkzMarkSegment[mark=||](Y,Y');
            \foreach \point in {(F), (X), (Y), (X'), (Y'), (P)}{
    \fill \point circle (0.4pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $P$ лежит на директрисе, тогда если $X\,'$ и $Y\,'$ -- проекции $X$ и $Y$ на директрису соответственно, то $\triangle PXX\,'= \triangle PXF$, а значит $\angle PFX=\angle PX\,'X=90^{\circ}$. Аналогично $\angle PFY=90^{\circ}$. То есть $X$, $F$ и $Y$ коллинеарны. При этом $\angle XPX\,'=\angle XPF,\,\angle YPF=\angle YPY\,'$, следовательно, $\angle XPY=\dfrac{1}{2}(\angle FPX\,'+\angle FPY\,')=90^{\circ}$.
    \end{proof}
    \begin{theorem}
        Пусть $PX$ и $PY$ – касательные к параболе, а $l$ – прямая, проходящая через $P$ параллельно оси параболы. Тогда угол между прямыми $PY$ и $l$ равен $\angle XPF$, $\triangle XFP \sim \triangle PFY$ и $FP$ -- биссектриса $\angle XFY$.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale = 4.5]
            \begin{scope}
                \clip (-1,-.6) rectangle (1,0.7);
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-1/4)});
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-.63*\x-.1)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(1.1*\x-.3)});
            \end{scope}
            \coordinate (X) at (-.32,.1);
            \coordinate (Y) at (.56,.31);
            \coordinate (X') at (-.32,-.25);
            \coordinate (Y') at (.56,-.25);
            \coordinate (F) at (0,0.25);
            \draw (X) node[below left] {$X$};
            \draw (Y) node[below right] {$Y$};
            \draw (X') node[below left] {$X\,'$};
            \draw (Y') node[below right] {$Y\,'$};
            \draw (F) node[above] {$F$};
            \tkzDefCircle[circum](F,X',Y')
            \tkzGetPoint{P} \tkzGetLength{rayon}
            \draw[dotted] (P) circle(\rayon);
            \draw (P) node[right] {$P$};
            \begin{scope}
                \clip (-1,-.6) rectangle (1,0.7);
                \draw[dashed] (P) -- ++(0,-10);
            \end{scope}
            \draw[dashed, name path = line1] (P) -- ++(0,.9);
            \draw[dashed] (X) -- (X');
            \draw[dashed] (Y) -- (Y');
            \draw[dashed] (X') -- (F) -- (Y');
            \draw[name path = line2] (X) -- (F) -- (Y);
            \draw (X') -- (P) -- (Y');
            \draw (F) -- (P);
            \coordinate (K) at (-1,-.25);
            \coordinate (L) at (1,-.25);
            \coordinate (M) at ($(P) + (0,-1)$);
            \coordinate (H) at ($(X')!(P)!(Y')$);
            \draw[name intersections={of=line1 and line2}] (intersection-1) node[above] {};
            \coordinate (N) at (intersection-1);
            \tkzMarkRightAngle[scale=.5](X,X',K);
            \tkzMarkRightAngle[scale=.5](L,Y',Y);
            \tkzMarkRightAngle[scale=.5](M,H,Y');
            \tkzMarkAngle[size=.1](X,P,X');
            \tkzMarkAngle[size=.12](F,P,X);
            \tkzMarkAngle[size=.1](Y,P,N);
            \tkzMarkAngle[size=.1](N,Y,P);
            \tkzMarkAngle[size=.12](P,Y,Y');
            \tkzMarkAngle[size=.1](X,F,P);
            \tkzMarkAngle[size=.12](P,F,Y);
            \tkzMarkAngle[size=.05](X,F,P);
            \tkzMarkAngle[size=.06](P,F,Y);
            \foreach \point in {(F), (X), (Y), (X'), (Y'), (P)}{
    \fill \point circle (0.4pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $X\,'$ и $Y\,'$ -- проекции $X$ и $Y$ на директрису соответственно. Угол между $PY$ и $l$ равен $\angle X\,'Y\,'F$, так как $l\perp X\,'Y\,'$ и $PY\perp Y\,'F$. При этом по лемме 3.8 $F$, $X\,'$ и $Y\,'$ лежат на окружности с центром в $P$. Тогда $\angle X\,'Y\,'F=\dfrac{1}{2}\angle X\,'PF=\angle XPF$. Поскольку $l\parallel YY\,'$, угол между $PY$ и $l$ равен $\angle PYY\,'$, который в силу оптического свойства параболы равен $\angle PYF$. То есть $\angle PYF=\angle XPF$, аналогично $\angle FXP = \angle YPF$. Тогда $\triangle XFP \sim \triangle PFY$ по двум углам и $PF$ -- биссектриса $\angle XFY$.
    \end{proof}

\setcounter{subsection}{2}
\subsection{Прямая Симсона}

    \begin{theorem}[Прямая Симсона]
        Проекции точки $P$ на стороны $\triangle ABC$ лежат на одной прямой тогда и только тогда, когда точка $P$ лежит на описанной окружности треугольника.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}
            \def\r{3}
                \coordinate (O) at (0,0);
                \coordinate (A) at (-145:\r);
                \coordinate (B) at (60:\r);
                \coordinate (C) at (-35:\r);
                \coordinate (P) at (-70:\r);
                \coordinate (K) at ($(B)!1.3!(C)$);
                \coordinate (Pc) at ($(A)!(P)!(B)$);
                \coordinate (Pb) at ($(A)!(P)!(C)$);
                \coordinate (Pa) at ($(B)!(P)!(C)$);
                \draw (O) circle (\r);
                \draw (A) -- (B) -- (C) -- cycle;
                \draw (A) node[below left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[right] {$C$};
                \draw (P) node[below] {$P$};
                \draw (Pa) node[right] {$P_a$};
                \draw (Pb) node[above] {$P_b$};
                \draw (Pc) node[above] {$P_c$};
                \draw (C) -- (K);
                \draw ($(Pc)!1.2!(Pa)$) -- ($(Pa)!1.2!(Pc)$);
                \draw[dashed] (P) -- (C);
                \draw[dashed] (P) -- (A);
                \draw[dashed] (P) -- (Pa);
                \draw[dashed] (P) -- (Pc);
                \draw[dashed] (P) -- (Pb);
                \tkzMarkRightAngle(P,Pc,A);
                \tkzMarkRightAngle(P,Pb,A);
                \tkzMarkRightAngle(P,Pa,K);
                \foreach \point in {(A), (B), (C), (P), (Pa), (Pb), (Pc)}{
    \fill \point circle (1.8pt);
}
            \end{tikzpicture}
        \end{center}
        Пусть $P_a$, $P_b$ и $P_c$ -- проекции точки $P$ на $BC$, $AC$ и $AB$ соответственно. $AP_cP_bP$ вписанный, так как $\angle AP_cP=\angle AP_bP$. Тогда $\angle APP_c=\angle AP_bP_C$. Аналогично $\angle CP_bP_a=\angle CPP_a$. В силу вписанности $ABCP$ $\angle PCP_a=180^{\circ}-\angle BCP=\angle BAP$. При этом $\angle PCP_a=90^{\circ}-\angle CPP_a=90^{\circ}-\angle CP_bP_a$. То есть $\angle AP_cP=90^{\circ}-\angle APP_c=90^{\circ}-\angle AP_bP_c=90^{\circ}-\angle CP_bP_a$, а значит $\angle AP_bP_c=\angle CP_bP_a$. В таком случае они вертикальные, следовательно, $P_a$, $P_b$ и $P_c$ коллинеарны. Обратное утверждение доказывается аналогично.
    \end{proof}

    \begin{theorem}
        Пусть $\triangle ABC$ описан около параболы, тогда фокус этой параболы лежит на описанной окружности этого треугольника.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale = 2]
            \begin{scope}
                \clip (-2,-2.5) rectangle (2,2);
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x)^2});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-2.45*\x-1.5)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(3.46*\x-3)});
            \end{scope}
            \coordinate (A) at (-.43,-.47);
            \coordinate (B) at (1.06,.66);
            \coordinate (C) at (.25,-2.12);
            \coordinate (F) at (0,.25);
            \coordinate (K) at ($(C)!2!(A)$);
            \draw (A) -- (B);
            \draw (A) node[below left] {$A$};
            \draw (B) node[below right] {$B$};
            \draw (C) node[below left] {$C$};
            \draw (F) node[above] {$F$};
            \coordinate (Fc) at ($(A)!(F)!(B)$);
            \coordinate (Fb) at ($(A)!(F)!(C)$);
            \coordinate (Fa) at ($(B)!(F)!(C)$);
            \draw (Fa) node[below right] {$F_a$};
            \draw (Fb) node[below left] {$F_b$};
            \draw (Fc) node[below right] {$F_c$};
            \draw (F) -- (Fa);
            \draw (F) -- (Fb);
            \draw (F) -- (Fc);
            \draw ($(Fb)!1.2!(Fa)$) -- ($(Fa)!1.2!(Fb)$);
            \tkzDefCircle[circum](A,B,C)
            \tkzGetPoint{O} \tkzGetLength{rayon}
            \draw (O) circle(\rayon);
            \tkzMarkRightAngle[scale=.8](F,Fc,A);
            \tkzMarkRightAngle[scale=.8](F,Fb,K);
            \tkzMarkRightAngle[scale=.8](F,Fa,B);
            \foreach \point in {(F), (A), (B), (C), (Fa), (Fb), (Fc)}{
    \fill \point circle (0.9pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $F_a$, $F_b$ и $F_c$ -- проекции фокуса параболы на стороны треугольника. По лемме 3.7 они коллинеарны. Тогда по теореме о прямой Симсона $F$ принадлежит окружности, описанной около $\triangle ABC$.
    \end{proof}

    \begin{theorem}
        Пусть $P$ и $B\,'$ лежат на окружности, описанной около $\triangle ABC$, при чем $PB\,'\perp AC$. Тогда $BB\,'$ параллельная прямой Симсона точки $P$.
    \end{theorem}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}
            \def\r{3}
                \coordinate (O) at (0,0);
                \coordinate (A) at (-165:\r);
                \coordinate (B) at (50:\r);
                \coordinate (C) at (-15:\r);
                \coordinate (P) at (-70:\r);
                \coordinate (B') at (70:\r);
                \coordinate (Pc) at ($(A)!(P)!(B)$);
                \coordinate (Pb) at ($(A)!(P)!(C)$);
                \draw (O) circle (\r);
                \draw (A) -- (B) -- (C) -- cycle;
                \draw (A) node[below left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[below right] {$C$};
                \draw (P) node[below] {$P$};
                \draw (Pb) node[above right] {$P_b$};
                \draw (Pc) node[above left] {$P_c$};
                \draw (B') node[above right] {$B\,'$};
                \draw (Pc) -- (Pb);
                \draw (P) -- (A);
                \draw (P) -- (Pc);
                \draw (P) -- (B');
                \draw (B) -- (B');
                \tkzMarkRightAngle(P,Pc,A);
                \tkzMarkRightAngle(P,Pb,A);
                \tkzMarkAngle[size=.4](B',B,A);
                \tkzMarkAngle[size=.4](Pb,Pc,B);
                \tkzMarkAngle[size=.4](B',P,A);
                \foreach \point in {(A), (B), (C), (P), (Pb), (Pc), (B')}{
    \fill \point circle (1.8pt);
}
            \end{tikzpicture}
        \end{center}
        Пусть $P_b$ и $P_c$ -- проекции $P$ на $AC$ и $AB$ соответственно. $\angle ABB\,'=\angle APB\,'$ как вписанные. $AP_cP_bP$ -- вписанный, так как $\angle AP_cP=\angle AP_bP$, следовательно, $\angle APP_b=\angle P_bP_cB$. То есть $\angle P_cBB\,'=\angle P_bP_cB$, а значит $BB\,'\parallel P_bP_c$.
    \end{proof}

    \setcounter{subsection}{13}
    \setcounter{consequence}{0}
    \begin{consequence}
        При вращении точки $P$ по окружности прямая Симсона вращается в противоположную сторону, причем скорость ее вращения в два раза меньше, чем скорость изменения дуги $PA$.
    \end{consequence}
    \begin{consequence}
        Прямая Симсона точки $P$ относительно $\triangle ABC$ делит отрезок $PH$ пополам, где $H$ -- ортоцентр $\triangle ABC$.
    \end{consequence}
    \begin{proof}
    $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}
            \def\r{3}
                \coordinate (O) at (0,0);
                \coordinate (A) at (-165:\r);
                \coordinate (B) at (50:\r);
                \coordinate (C) at (-15:\r);
                \coordinate (P) at (-70:\r);
                \coordinate (B') at (70:\r);
                \coordinate (Pc) at ($(A)!(P)!(B)$);
                \coordinate (Pb) at ($(A)!(P)!(C)$);
                \coordinate (Hb) at ($(A)!(B)!(C)$);
                \coordinate (Hc) at ($(A)!(C)!(B)$);
                \coordinate (H') at (-50:\r);
                \coordinate (P') at ($(P)!2!(Pb)$);
                \draw (O) circle (\r);
                \draw (A) -- (B) -- (C) -- cycle;
                \draw (A) node[below left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[below right] {$C$};
                \draw (P) node[below] {$P$};
                \draw (Pb) node[below left] {$P_b$};
                \draw (Pc) node[above] {$P_c$};
                \draw (B') node[above right] {$B\,'$};
                \draw (H') node[below right] {$H\,'$};
                \draw (P') node[below left] {$P\,'$};
                \draw ($(Pc)!1.68!(Pb)$) -- ($(Pb)!1.5!(Pc)$);
                \draw (P) -- (A);
                \draw (P) -- (Pc);
                \draw (P) -- (B');
                \draw (B) -- (B');
                \draw (B) -- (H');
                \draw (P) -- (H');
                \draw[draw opacity = 0, name path =line1] (B) -- (Hb);
                \draw[draw opacity = 0, name path = line2] (C) -- (Hc);
                \draw[name intersections={of=line1 and line2}] (intersection-1) node[below left] {$H$};
                \coordinate (H) at (intersection-1);
                \draw (P') -- (H);
                \tkzMarkRightAngle(P,Pc,A);
                \tkzMarkRightAngle(C,Pb,B');
                \tkzMarkRightAngle(C,Hb,B);
                \tkzMarkAngle[size=.4](B',B,A);
                \tkzMarkAngle[size=.4](Pb,Pc,B);
                \tkzMarkAngle[size=.4](B',P,A);
                \tkzMarkSegment[mark=|](H,Hb);
                \tkzMarkSegment[mark=|](Hb,H');
                \tkzMarkSegment[mark=||](P',Pb);
                \tkzMarkSegment[mark=||](Pb,P);
                \foreach \point in {(A), (B), (C), (P), (Pb), (Pc), (B'), (H'), (P'), (H)}{
    \fill \point circle (1.8pt);
}
            \end{tikzpicture}
        \end{center}
        Пусть $H\,'$ и $P\,'$ -- образы $H$ и $P$ относительно $AC$ соответственно. Поскольку $PB\,'\parallel H\,'B$, $PB\,'BH\,'$ -- равнобокая трапеция. Тогда отрезок, симметричный $PH\,'$ относительно $AC$ должен быть параллелен $BB\,'$, то есть $P\,'H\parallel B\,'B\parallel P_cP_b$. Поскольку $P_b$ -- середина $PP\,'$ и $P_cP_b\parallel P\,'H$, прямая Симсона -- средняя линия $\triangle HPP\,'$, а значит делит $HP$ пополам.
    \end{proof}
    \begin{theorem}
        Ортоцентр треугольника, описанного около параболы, лежит на ее директрисе.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale = 1.5]
            \begin{scope}
                \clip (-4,-2.5) rectangle (2,3);
                \draw[domain=-4:4, variable=\x, samples=100] plot ({(\x)},{(\x*0.6)^2+0.5});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(-3.67*\x-8.78)});
                \draw[domain=-4:4, variable=\x, samples=50] plot ({(\x)},{(.94*\x-0.12)});
            \end{scope}
            \coordinate (A) at (-2.84,1.64);
            \coordinate (B) at (.34,.2);
            \coordinate (C) at (-1.89,-1.9);
            \coordinate (F) at (0,1.19);
            \coordinate (K) at ($(C)!2!(B)$);
            \coordinate (Hb) at ($(A)!(B)!(C)$);
            \coordinate (Hc) at ($(A)!(C)!(B)$);
            \draw (A) -- (B);
            \draw (A) node[above left] {$A$};
            \draw (B) node[below right] {$B$};
            \draw (C) node[right] {$C$};
            \draw (F) node[above right] {$F$};
            \coordinate (Fb) at ($(A)!(F)!(C)$);
            \coordinate (Fa) at ($(B)!(F)!(C)$);
            \draw (Fa) node[below right] {$F_a$};
            \draw (Fb) node[below left] {$F_b$};
            \draw (F) -- (Fa);
            \draw (F) -- (Fb);
            \draw[name path = line3] ($(Fb)!1.2!(Fa)$) -- ($(Fa)!1.2!(Fb)$);
            \draw[draw opacity = 0, name path =line1] (B) -- (Hb);
            \draw[draw opacity = 0, name path = line2] (C) -- (Hc);
            \draw[name intersections={of=line1 and line2}] (intersection-1) node[below left] {$H$};
            \coordinate (H) at (intersection-1);
            \draw[name path = line4] (F) -- (H);
            \draw[name intersections={of=line3 and line4}] (intersection-1) node[below right] {$O$};
            \coordinate (O) at (intersection-1);
            \coordinate (Hf) at ($(Fa)!(H)!(Fb)$);
            \coordinate (Ff) at ($(Fa)!(F)!(Fb)$);
            \draw (H) -- (Hf);
            \draw (F) -- (Ff);
            \tkzMarkRightAngle[scale=.8](H,Hf,Fb);
            \tkzMarkRightAngle[scale=.8](F,Ff,Fa);
            \tkzMarkRightAngle[scale=.8](F,Fb,A);
            \tkzMarkRightAngle[scale=.8](F,Fa,K);
            \tkzMarkSegment[mark=|](H,O);
            \tkzMarkSegment[mark=|](O,F);
            \foreach \point in {(F), (A), (B), (C), (Fa), (Fb), (H), (O)}{
    \fill \point circle (1.2pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $F_a$ и $F_b$ -- проекции $F$ на $BC$ и $AC$ соответственно. Тогда по следствию 3.7.1 $F_bF_a$ -- прямая, касающаяся параболы в ее вершине и параллельная директрисе этой параболы. Пусть $O$ -- точка пересечения $FH$ и $F_bF_a$, тогда по следствию 3.13.2 $FO=OH$, при этом $\angle HOF_b=\angle FOF_a$ как вертикальные, в таком случае равны по двум углам и стороне треугольники, образованные $F$, $O$, $H$ и проекциями $F$ и $H$ на $F_bF_a$. Следовательно, расстояние от $F$ до прямой, проходящей через вершину параболы и параллельной ее директрисе, равно расстоянию от этой прямой до $H$, а значит $H$ лежит на директрисе параболы.
    \end{proof}

    \section{Гомотетия}

    \begin{definition}
        Гомотетия с центром $O$ и коэффициентом $k$ суть преобразование плоскости, при котором $\forall A \in \R^2: H_O^k(A)=A\,':\,\overrightarrow{OA}\cdot k = \overrightarrow{OA\,'},\,\overrightarrow{OA} \upuparrows \overrightarrow{OA\,'}$.
    \end{definition}

    \setcounter{subsection}{0}
    \subsection{Композиция гомотетий}
    \begin{definition}
        Композиция гомотетий $H_O^k$ и $H_P^l$ при $k,\,l\neq 1$ -- это параллельный перенос при $k\cdot l=1$ или $H_Q^{kl}:\,Q \in OP,\, \overrightarrow{OQ}\cdot (k-1)=\overrightarrow{QP}\cdot \left(1-\dfrac{1}{l}\right)$.
    \end{definition}

    \section{Инверсия}
    \begin{definition}
        Точки $A$ и $B$ называются симметричными относительно окружности\\ $\omega(O;\,R)$, если $OA\cdot OB=R^2$ и $A$ лежит на луче $OB$.\bigskip

        Для точек, симметричных относительно окружности $\omega(O;\,R)$, выполняются условия:
        \begin{align*}
            1.\,\,&\forall X\in \R^2:\,X\neq0\,\,\,\exists!\,Y:\,X,\,Y \text{ -- симметричны относительно } \omega\\
            2.\,\,&\text{Если } X \text{ внутри } \omega\text{, то } Y \text{ снаружи и наоборот}\\
            3.\,\,&\text{Нет точки, симметричной } O\\
            4.\,\,&\forall C \in \omega:\,C \text{ симметрична сама себе}
        \end{align*}
    \end{definition}

    \begin{definition}
        Пусть на плоскости дана окружность $\omega(O;\,R)$. Отображение $\varphi:\,\R^2/\{0\}\longrightarrow \R^2/\{0\}$, при котором точки переходят в симметричные им относительно $\omega$, называется инверсией.
    \end{definition}
    \begin{lemma}[Основная лемма]
        Любые две пары точек, симметричных относительно одной окружности, лежат на одной окружности.
    \end{lemma}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}
                \coordinate (O) at (0,0);
                \coordinate (B) at (30:2);
                \coordinate (B') at (30:4.5);
                \coordinate (A) at (-20:1.8);
                \coordinate (A') at (-20:5);
                \draw (O) node[above left]{$O$};
                \draw (A) node[below left]{$A$};
                \draw (A') node[below right]{$\widehat{A}$};
                \draw (B) node[above left]{$B$};
                \draw (B') node[above right]{$\widehat{B}$};
                \draw (135:3) node[above left]{$\omega$};
                \draw (O) -- (B');
                \draw (O) -- (A');
                \draw (A') -- (B');
                \draw (A) -- (B);
                \tkzMarkAngle[size=.4](O,B,A);
                \tkzMarkAngle[size=.4](B',A',O);
                \tkzMarkAngle[size=.4](O,B',A');
                \tkzMarkAngle[size=.4](B,A,O);
                \tkzMarkAngle[size=.3](B,A,O);
                \tkzMarkAngle[size=.3](O,B',A');
                \tkzDefCircle[circum](A,A',B)
            \tkzGetPoint{M} \tkzGetLength{rayon}
            \draw[dashed] (M) circle(\rayon);
                \draw (O) circle(3);
        \foreach \point in {(O), (B), (B'), (A), (A')}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $A$ и $\widehat{A}$, $B$ и $\widehat{B}$ -- пары точек, симметричных около окружности $\omega(O;\,R)$. Тогда:
        $$OA\cdot O\widehat{A}=R^2=OB\cdot O\widehat{B}\Longleftrightarrow \frac{OA}{OB}=\frac{O\widehat{B}}{O\widehat{A}}$$
        Следовательно, по двум сторонам, а также по общему углу $\triangle AOB \sim \triangle \widehat{B}O\widehat{A}$. Отсюда $\angle ABO=\angle O\widehat{A}\widehat{B}$ и $\angle OAB=\angle O\widehat{B}\widehat{A}$, а значит $\widehat{A}AB\widehat{B}$ -- вписанный, так как сумма его противоположных углов равна $180^{\circ}$.
    \end{proof}

    \begin{theorem}
        Прямая, не проходящая через центр инверсии, переходит в окружность, проходящую через центр инверсии.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}
                \coordinate (O) at (0,0);
                \coordinate (A) at (15:3);
                \coordinate (B) at (-80:3);
                \coordinate (M) at ($(A)!0.5!(B)$);
                \draw (O) circle(3);
                \tkzCalcLength(O,M)\tkzGetLength{OM}
                \coordinate (M') at (-32.5:{9/\OM});
                \coordinate (D) at ($(B)!1.25!(A)$);
                \tkzCalcLength(O,D)\tkzGetLength{OD}
                \def\length{9/(\OD*\OD)}
                \coordinate (D') at ($(O)!\length!(D)$);
                \draw (O) -- (D);
                \draw (O) -- ($(O)!1.3!(M')$);
                \draw[name path =line1] (M') -- (D');
                \draw[name path = line2] ($(A)!-0.5!(B)$) -- ($(A)!1.3!(B)$);
                \draw[name intersections={of=line1 and line2}] (intersection-1) node[left] {$T$};
                \coordinate (T) at (intersection-1);
                \draw[dashed] (O) -- (A) -- (M');
                \draw (D) -- (M');
                \draw (M) -- (D');
                \tkzMarkRightAngle(M',A,O);
                \tkzMarkRightAngle(D,D',M');
                \tkzMarkRightAngle(D,M,M');
                \draw (O) node[above left]{$O$};
                \draw (A) node[right]{$A$};
                \draw (B) node[below]{$B$};
                \draw (M) node[left]{$M$};
                \draw (D) node[above left]{$D$};
                \draw (M') node[below left]{$\widehat{M}$};
                \draw (D') node[above left]{$\widehat{D}$};
                \tkzDefCircle[circum](M,D',D)
            \tkzGetPoint{K} \tkzGetLength{rayon}
            \draw[dotted, line width = 0.2mm] (K) circle(\rayon);
            \tkzDefCircle[circum](A,O,B)
            \tkzGetPoint{L} \tkzGetLength{rayon}
            \draw[dotted, line width = 0.2mm] (L) circle(\rayon);
            \draw ($(B)!-0.2!(A)$) node[above left] {$l$};
            \tkzMarkSegment[mark=|](B,M);
            \tkzMarkSegment[mark=|](M,A);
            \draw (135:3) node[above left]{$\omega$};

        \foreach \point in {(O), (B), (M), (A), (M'), (D), (D'), (T)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $M$ -- основание серединного перпенидкуляра, опущенного из $O$ на $l$, $D$ -- произвольная точка вне окружности, а $\widehat{M}$ и $\widehat{D}$ -- точки, симметричные $M$ и $D$ соответственно относительно $\omega$, $T$ -- точка пересечения $l$ и $\widehat{D}\widehat{M}$. Из построения инверсии, $AM$ -- касательная к $\omega$. Тогда $\angle OA\widehat{M}=90^{\circ}$. По основной лемме $D\widehat{D}M\widehat{M}$ -- вписанный. Тогда $\angle D\widehat{D}\widehat{M}=\angle DM\widehat{M}=90^{\circ}=\angle OA\widehat{M}$. А значит $O\widehat{D}A\widehat{M}$ -- вписанный по признаку.
    \end{proof}
    \begin{theorem}
        Если при инверсии $\varphi$ верно: $\varphi(\omega_1)=\omega_2$, где $\omega_i$ -- это  окружность, то центр данной инверсии суть центр гомотетии, переводящей $\omega_1$ в $\omega_2$.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale=0.8]
                \coordinate (O) at (0,0);
                \coordinate (A) at (125:1.5);
                \coordinate (B) at (150:1.5);
                \coordinate (A') at (125:6);
                \coordinate (B') at (150:6);
                \coordinate (C) at (140:4);
                \coordinate (C') at (140:2.25);
                \draw (O) circle(3);
                \draw (B') -- (O) -- (A');
                \draw (B') node[left] {$\varphi(B)$};
                \draw (A') node[above] {$\varphi(A)$};
                \draw (A) node[right] {$A$};
                \draw (B) node[below] {$B$};
                \draw (O) node[above right] {$O$};
                \draw (137.5:6.2) node[above left] {$\omega_2$};
                \draw (137.5:4) node[above left] {$\omega_1$};
                \draw (O) -- (0:3);
                \tkzDefCircle[circum](A,B,C)
            \tkzGetPoint{K} \tkzGetLength{rayon}
            \draw (K) circle(\rayon);
            \tkzDefCircle[circum](A',B',C')
            \tkzGetPoint{L} \tkzGetLength{rayon}
            \draw (L) circle(\rayon);
            \draw (0:1.5) node[below] {$R$};
        \foreach \point in {(A), (B), (A'), (B'), (O), (0:3)}{
    \fill \point circle (2.25pt);
}
        \end{tikzpicture}
        \end{center}
        Возьмем две произвольные точки $A$ и $B$, лежащие на $\omega_1$ и построим их образы при инверсии $\varphi$: $\varphi(A)$ и $\varphi(B)$ соответственно. По определению инверсии $OA\cdot O\varphi(A)=R^2=OB\cdot O\varphi(B)\Longrightarrow \dfrac{OA}{OB}=\dfrac{O\varphi(A)}{O\varphi(B)}$, а значит $O$ -- центр гомотетии, переводящей $\omega_1$ в $\omega_2$.
    \end{proof}
    \section{Полезные факты}
    \begin{lemma}
        Пусть $C_0$ и $A_0$ -- произвольные точки на сторонах $AB$ и $BC$ треугольника $ABC$, $B_1$ -- середина дуги $ABC$, описанной около $\triangle ABC$ окружности, тогда $BB_1C_0A_0$ является вписанным тогда и только тогда, когда $AC_0=CA_0$. 
    \end{lemma}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale=0.8]
                \coordinate (A) at (-140:4);
                \coordinate (B) at (55:4);
                \coordinate (C) at (-40:4);
                \coordinate (B1) at (90:4);
                \coordinate (A0) at ($(B)!0.3!(C)$);
                \tkzDefCircle[circum](A0,B1,B)
            \tkzGetPoint{K} \tkzGetLength{rayon}
            \draw[name path = line1] (K) circle(\rayon);
                \draw (B) -- (C) -- (A) -- cycle;
                \draw[name path = line2] (A) -- ($(A)!0.9!(B)$);
                \draw[name intersections={of=line1 and line2}] (intersection-1) node[below] {$C_0$};
                \coordinate (C0) at (intersection-1);
                \draw (0,0) circle(4);
                \draw[dotted, line width = 0.2mm] (B1) -- (C0) -- (A0) -- (B1) -- (B);
                \draw[dashed] (A) -- (B1) -- (C);
                \draw[dashed] (B1) -- (-90:4);
                \coordinate (Mb) at ($(A)!0.5!(C)$);
                \draw (A) node[below left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[below right] {$C$};
                \draw (Mb) node[below right] {$M_b$};
                \draw (A0) node[below right] {$A_0$};
                \draw (B1) node[above] {$B_1$};
                \tkzMarkRightAngle(B1,Mb,A);
                \tkzMarkSegment[mark=|](A,C0);
                \tkzMarkSegment[mark=|](C,A0);
        \foreach \point in {(A), (B), (C), (B1), (A0), (C0), (Mb)}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $AC_0=CA_0$, докажем вписанность $BB_1C_0A_0$. Опустим перпендикуляр с основанием $M_b$ из $B_1$ на $AC$, тогда в силу того, что $B_1$ -- середина дуги $ABC$, $B_1M_b$ -- серединный перпендикуляр к $AC$. Тогда $AB_1=B_1C$. Рассмотрим $\triangle AB_1C_0$ и $\triangle CB_1A_0$: $\angle B_1AB=\angle B_1CB$, так как они опираются на одну дугу $B_1B$, при этом $AC_0=CA_0$ по условию и $AB_1=B_1C$. То есть $\triangle AB_1C_0=\triangle CB_1A_0$, а значит равны их внешние углы: $\angle B_1C_0B=\angle B_1A_0B$, тогда $BB_1C_0A_0$ -- вписанный по признаку.\bigskip

        Докажем, что $AC_0=CA_0$ при условии вписанности $BB_1C_0A_0$. Аналогично первому доказательству, $\angle B_1AB=\angle B_1CB$ и в силу вписанности $\angle B_1C_0B=\angle B_1A_0B$, при этом $AB_1=B_1C$, а значит $\triangle AB_1C_0=\triangle CB_1A_0$ по двум углам и стороне, то есть $AC_0=CA_0$.
    \end{proof}
    \begin{lemma}
        Пусть $A_0$ и $C_0$ -- произвольные точки на $BC$ и $AB$ треугольника $ABC$ соответственно. Инцентр $\triangle ABC$ лежит на окружности, описанной около $\triangle A_0BC_0$ тогда и только тогда, когда $AC_0+CA_0=AC$.
    \end{lemma}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[scale=0.9]
                \coordinate (A) at (0,0);
                \coordinate (B) at (5.5,6);
                \coordinate (C) at (8,0);
                \coordinate (A0) at ($(B)!0.35!(C)$);
                \tkzDefLine[bisector](B,A,C)\tkzGetPoint{a}
                \path[name path = line1] ($(A)!0.2!(a)$) -- ($(A)!1.2!(a)$);
                \draw[name path = line2] (A) -- (B) -- (C) -- cycle;
                \draw[name intersections={of=line1 and line2}] (intersection-1) node[right] {$L_A$};
                \coordinate (La) at (intersection-1);
                \tkzDefLine[bisector](A,C,B)\tkzGetPoint{c}
                \path[name path = line3] ($(C)!0.2!(c)$) -- ($(C)!1.5!(c)$);
                \draw[name intersections={of=line3 and line2}] (intersection-1) node[above left] {$L_C$};
                \coordinate (Lc) at (intersection-1);
                \draw[name path = line4, dashed] (A) -- (La);
                \draw[name path = line5, dashed] (C) -- (Lc);
                \draw[name intersections={of=line4 and line5}] (intersection-1) node[below] {$I$};
                \coordinate (I) at (intersection-1);
                \tkzDefCircle[circum](A0,I,B)
                \tkzGetPoint{O} \tkzGetLength{rayon}
                \draw[name path = line6] (O) circle(\rayon);
                \path[name path = line7] (A) -- ($(A)!0.9!(B)$);
                \draw[name intersections={of=line6 and line7}] (intersection-1) node[left] {$C_0$};
                \coordinate (C0) at (intersection-1);
                \draw (A) node[below left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[below right] {$C$};
                \draw (A0) node[right] {$A_0$};
                \tkzCalcLength(A,C0)\tkzGetLength{simm}
                \coordinate (C0') at (\simm, 0);
                \draw (C0') node[below] {$\widehat{C_0}$};
                \draw (A0) -- (I) -- (C0) -- (C0') -- (I);
                \tkzMarkAngle[size=.4](I,A0,C);
                \tkzMarkAngle[size=.4](I,C0,B);
                \tkzMarkAngle[size=.4](C,C0',I);
                \tkzMarkAngle[size=.4](I,C,A);
                \tkzMarkAngle[size=.55](La,C,I);
                \tkzMarkAngle[size=.3](I,C,A);
                \tkzMarkAngle[size=.45](La,C,I);
        \foreach \point in {(A), (B), (C), (A0), (La), (Lc), (C0), (I), (C0')}{
    \fill \point circle (1.8pt);
}
        \end{tikzpicture}
        \end{center}
        Пусть $L_A$ и $L_C$ -- основания биссектрис из точек $A$ и $C$ соответственно. Отметим точку $\widehat{C_0}$, симметричную $C_0$ относительно $AL_A$. Докажем равенство при условии вписанности. В силу вписанности $A_0IC_0B$: $\angle IA_0C=\angle IC_0B$. При этом в силу симметрии $\angle IC_0B=\angle I\widehat{C_0}C$. Также $\angle IC\widehat{C_0}=\angle ICL_A$, так как $CI$ -- биссектриса. Тогда $\triangle IC\widehat{C_0} = \triangle ICA_0$ по двум углам и общей стороне $IC$. То есть $\widehat{C_0}C=A_0C$, а значит $A\widehat{C_0} + \widehat{C_0}C=A\widehat{C_0}+A_0C=AC_0+A_0C=AC$.\bigskip

        Докажем вписанность при условии равенства. В силу симметрии $\angle IC_0B=\angle I\widehat{C_0}C$. $AC=AC_0+A_0C=A\widehat{C_0}+A_0C\Longrightarrow A_0C=C\widehat{C_0}$. Тогда $\triangle IC\widehat{C_0} = \triangle ICA_0$ по двум сторонам и углу, а значит $\angle I\widehat{C_0}C=\angle IA_0C$, то есть $\angle IA_0C=\angle IC_0B$, следовательно, $A_0IC_0B$ -- вписанный.
    \end{proof}

    \section{Стереометрия}

    \subsection{Введение}
    
    \begin{axiom}
        В $\R^3$ существуют плоскости, причем для любой из них выполняются аксиомы планиметрии.
    \end{axiom}
    \begin{axiom}[Аксиома плоскости]
        Через любые три неколлинеарные точки пространства проходит плоскость, при чем только одна.
    \end{axiom}
    \begin{axiom}
        Прямая, проходящая через две точки плоскости полностью лежит в данной плоскости.
    \end{axiom}
    \begin{axiom}[Аксиома пересечения плоскостей]
        Если две плоскости имеют общую точку, то они пересекаются по прямой:
        $$M \in \alpha;\,M \in \beta \Longrightarrow \exists\,\,l:\,\,l\subset \alpha;\,l\subset \beta$$
    \end{axiom}
    \begin{axiom}[Аксиома расстояния]
        В любой из плоскостей, проходящих через две различные точки расстояние между этими точками одно и то же:
        $$A \neq B;\,\,\forall\,\alpha:\,\,A,\,B\in\alpha\,\,\rho_\alpha(A;\,\,B)=\text{const}$$
    \end{axiom}
    \begin{definition}
        Прямая и плоскость называются пересекающимися, если они имеют одну общую точку.
    \end{definition}
    \begin{definition}
        Две плоскости называются пересекающимися, если они имеют одну общую прямую.
    \end{definition}
    \begin{definition}
        Прямые, лежащие в одной плоскости и не имеющие общих точек называются параллельными.
    \end{definition}
    
    \subsection{Следствия из аксиом}
    
    \begin{lemma}
        Через прямую и точку, не лежащую на ней, проходит плоскость, при том только одна:
        $$\forall\,A;\,\,\forall\,l:\,\,A\notin l\,\,\exists!\,\,\alpha:\,\,l\subset\alpha;\,\,A\in\alpha$$
    \end{lemma}
    
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(50:5mm)}]
                \begin{scope}[canvas is zy plane at x=0,fill=blue]
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0,fill=red]
                    \coordinate (A) at (7,-1);
                    \coordinate (D) at (0,-2);
                    \coordinate (E) at (6,3);
                    \coordinate (B) at ($(D)!0.25!(E)$);
                    \coordinate (C) at ($(D)!0.75!(E)$);
                    \draw ($(D)!0.5!(E)$) node[above] {$l$};
                    \draw (A) node[above] {$A$};
                    \draw (B) node[above] {$B$};
                    \draw (C) node[above] {$C$};
                  \draw[opacity=0.3] (0,-3) grid (8,3);
                  \draw (D) -- (E);
                \end{scope}
                \foreach \point in {(A), (B), (C)}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        Рассмотрим $B,\,C\in l:\,\,l\subset\alpha\Longrightarrow B,\,C\in\alpha.$ По аксиоме плоскости $\exists!\,\,\alpha:\,\,A,\,B,\,C\in\alpha;\,\,l\subset\alpha.$
    \end{proof}
    
    \begin{lemma}\label{Пересекающиеся прямые и плоскость}
        Через две пересекающиеся прямые проходит плоскость, при том только одна:
        $$a\cap b = C\Longrightarrow\exists!\,\,\alpha:\,\,a,\,b\subset\alpha$$
    \end{lemma}
    \begin{lemma}
        Через две параллельные прямые проходит плоскость, при том только одна:
        $$a\parallel b\Longrightarrow\exists!\,\,\alpha:\,\,a,\,b\subset\alpha$$
    \end{lemma}
    
    \subsection{Скрещивающиеся прямые}
    
    \begin{definition}
        Две прямые называются скрещивающимися, если у них нет общих точек и они не параллельны.
    \end{definition}
    
    \begin{theorem}[Признак скрещивающихся]
        Если одна прямая лежит в плоскости, а другая пересекают данную плоскость в точке, не лежащей на первой прямой, данные прямые скрещиваются:
        $$a\subset\alpha,\,b\cap\alpha=M:\,\,M\notin a\Longrightarrow a\dotdiv b$$
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                \begin{scope}[canvas is zy plane at x=0,fill=blue]
                    \coordinate (M) at (3,0);
                    \draw (M) node[above right] {$M$};
                    \draw ($(0,1.5)!0.5!(3,0)$) node[above] {$b$};
                    \draw (0,1.5) -- (3,0);
                    \draw[dashed] (0,1.5) -- ($(0,1.5)!1.65!(3,0)$);
                    \draw ($(0,1.5)!1.65!(3,0)$) -- ($(0,1.5)!2!(3,0)$);
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0,fill=red]
                    \draw ($(5,-3)!0.5!(6,3)$) node[above left] {$a$};
                    \draw (5,-3) -- (6,3);
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                \end{scope}
                \foreach \point in {(M)}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        Пусть $a$ и $b$ не скрещиваются. Тогда $a\parallel b$ или $a\cap b\neq\varnothing:
        $
        \begin{align*}
            1.\,\,&a\parallel b\Longrightarrow\exists!\,\,\beta:\,\,a,\,b\subset\beta\Longrightarrow M\in\beta,\text{ при этом }a\subset\alpha\text{ (по условию); }\\
            &a\subset\beta\text{ (по предложению)}\Longrightarrow \alpha\cap\beta=a,\,M\in\alpha,\,M\in\beta\Longrightarrow M\in a,\text{ противоречие.}\\
            2.\,\,&a\cap\beta\neq\varnothing\Longrightarrow\exists\,k:\,\,k\in a,\,k\in b\Longrightarrow\exists\,\beta:\,\,a,\,b\subset\beta\Longrightarrow M\in\beta,\text{ при этом }a\subset\alpha\text{ (по условию); }\\
            &a\subset\beta\text{ (по предложению)}\Longrightarrow \alpha\cap\beta=a,\,M\in\alpha,\,M\in\beta\Longrightarrow M\in a,\text{ противоречие.}
        \end{align*}
    \end{proof}
    \begin{theorem}
        Пусть $a\parallel b;\,\,a\cap\alpha\neq\varnothing,$ тогда $b\cap\alpha\neq\varnothing$.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                \begin{scope}[canvas is zy plane at x=0,fill=blue]
                    \coordinate (A) at (2,0);
                    \draw (A) node[above right] {$A$};
                    \draw (-1,1.5) -- (A);
                    \draw ($(-1,1.5)!0.35!(A)$) node[above right] {$a$};
                    \draw[dashed] (-1,1.5) -- ($(-1,1.5)!1.65!(A)$);
                    \draw ($(-1,1.5)!1.65!(A)$) -- ($(-1,1.5)!2!(A)$);
                \end{scope}
                \begin{scope}[canvas is zy plane at x=1,fill=blue]
                    \coordinate (B) at (6,0);
                    \draw (B) node[above right] {$B$};
                    \draw (3,1.5) -- (B);
                    \draw ($(3,1.5)!0.35!(B)$) node[above right] {$b$};
                    \draw[dashed] (3,1.5) -- ($(3,1.5)!1.65!(B)$);
                    \draw ($(3,1.5)!1.4!(B)$) -- ($(3,1.5)!2!(B)$);
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0,fill=red]
                    \draw ($(2,0)!-.5!(6,1)$) -- ($(2,0)!1.5!(6,1)$);
                    \draw ($(2,0)!0.5!(6,1)$) node[above] {$l$};
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                \end{scope}
                \foreach \point in {(A), (B)}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        $$a\parallel b\Longrightarrow\exists!\,\,\beta:\,\,a,\,b\subset\beta,\,a\cap\alpha=A\Longrightarrow A\in\beta\Longrightarrow\exists\,l:\,\,l=\alpha\cap\beta$$
        $$l\cap a=A,\,a\parallel\beta\Longrightarrow l\cap\beta=B:\,\,B\in b,\,B\in l\Longrightarrow b\cap\alpha=B.$$
    \end{proof}
    
    \subsection{Параллельность прямой и плоскости}
    
    \begin{definition}
        Прямая и плоскость называются параллельными, если они не имеют общих точек.
    \end{definition}
    
    \begin{theorem}[Признак параллельности прямой и плоскости]
        Если прямая, не лежащая в плоскости, параллельна какой-либо прямой, лежащей в этой плоскости, то эти прямая и плоскость параллельны:
        $$a\subset\alpha,\,b \not\subset \alpha,\,a\parallel b\Longrightarrow \alpha\parallel b$$
    \end{theorem}
    
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(25:5mm)},y={(60:7mm)}]
                \begin{scope}[canvas is zx plane at y=0]
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                    \draw (-0.5,-1.5) node[left] {$\alpha$};
                \end{scope}
                \begin{scope}[canvas is zy plane at x=0]
                    \fill[color=white] (0,0) rectangle (8,4);
                    \draw[opacity=0.2] (0,-2) grid (8,4);
                    \coordinate (A1) at (0,0);
                    \coordinate (A2) at (8,0);
                    \coordinate (B1) at (0,3);
                    \coordinate (B2) at (8,3);
                    \draw (A1) -- (A2);
                    \draw (B1) -- (B2);
                    \draw ($(A1)!0.5!(A2)$) node[above] {$a$};
                    \draw ($(B1)!0.5!(B2)$) node[above] {$b$};
                    \draw (-0.25,2) node[left] {$\beta$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \fill[color=white] (0,-3) rectangle (8,0);
                    \draw[opacity=0.2] (0,-3) grid (8,0);
                \end{scope}
                \foreach \point in {}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        \begin{center}
            $a\parallel b\Longrightarrow\exists!\,\,\beta:\,\,a,\,b\subset\beta$. Пусть $b\cap\alpha\neq\varnothing$. Но $\alpha\cap\beta=a$. Противоречие.
        \end{center}
    \end{proof}
    \begin{theorem}[О линии пересечения плоскостей]
        Если плоскость проходит через прямую, параллельную другой плоскости, и пересекает эту плоскость, то линия пересечения плоскостей параллельна данной прямой:
        $$a\parallel \alpha,\,a\subset\beta,\,\alpha\cap\beta=b\Longrightarrow a\parallel b$$
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(25:5mm)},y={(60:7mm)}]
                \begin{scope}[canvas is zx plane at y=0]
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                    \draw (-0.5,-1.5) node[left] {$\alpha$};
                \end{scope}
                \begin{scope}[canvas is zy plane at x=0]
                    \fill[color=white] (0,0) rectangle (8,4);
                    \draw[opacity=0.2] (0,-2) grid (8,4);
                    \coordinate (A1) at (0,0);
                    \coordinate (A2) at (8,0);
                    \coordinate (B1) at (0,3);
                    \coordinate (B2) at (8,3);
                    \draw (A1) -- (A2);
                    \draw (B1) -- (B2);
                    \draw ($(A1)!0.5!(A2)$) node[above] {$b$};
                    \draw ($(B1)!0.5!(B2)$) node[above] {$a$};
                    \draw (-0.25,2) node[left] {$\beta$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \fill[color=white] (0,-3) rectangle (8,0);
                    \draw[opacity=0.2] (0,-3) grid (8,0);
                \end{scope}
                \foreach \point in {}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        \begin{center}
            $a\parallel\alpha\Longrightarrow a\cap b=\varnothing.$ Пусть $a\dotdiv b$, тогда $a\cap\alpha\neq\varnothing$, но $a\parallel \alpha$. Противоречие.
        \end{center}
    \end{proof}
    
    \begin{theorem}[О крыше]
        Если через каждую из двух параллельных прямых проведена плоскость, причём эти плоскости пересекаются, то линия их пересечения параллельна каждой из данных прямых:
        $$a\parallel b,\,a\subset \alpha,\,b\subset \beta,\,\alpha\cap\beta=c\Longrightarrow a\parallel c,\, b\parallel c$$
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(120:5mm)},y={(45:7mm)}]
                \begin{scope}[canvas is zx plane at y=0]
                    \draw[opacity=0.2] (0,-3) grid (8,4);
                    \coordinate (B1) at (0,-2);
                    \coordinate (B2) at (8,-2);
                    \draw (B1) -- (B2);
                    \draw ($(B1)!0.77!(B2)$) node[above] {$b$};
                    \draw (8.3,0) node[right] {$\beta$};
                \end{scope}
                \begin{scope}[canvas is zy plane at x=3]
                    \fill[color=white] (0,0) rectangle (8,-6);
                    \draw[opacity=0.2] (0,1) grid (8,-6);
                    \coordinate (A1) at (0,-5);
                    \coordinate (A2) at (8,-5);
                    \draw (A1) -- (A2);
                    \draw ($(A1)!0.5!(A2)$) node[above] {$a$};
                    \draw (-0.3,-2) node[left] {$\alpha$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \fill[color=white] (0,3) rectangle (8,4);
                    \draw[opacity=0.2] (0,3) grid (8,4);
                    \coordinate (C1) at (0,3);
                    \coordinate (C2) at (8,3);
                    \draw (C1) -- (C2);
                    \draw ($(C1)!0.5!(C2)$) node[above] {$c$};
                \end{scope}
                \foreach \point in {}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        \begin{center}
            $a\parallel b,\,b\not\subset \alpha\Longrightarrow b\parallel \alpha\Longrightarrow b\parallel c\text{ (по теореме о линии пересечения плоскостей). Аналогично }c\parallel a.$
        \end{center}
    \end{proof}
    \setcounter{subsection}{8}
    
    \begin{consequence}
        Параллельность прямых в пространстве транзитивна.
    \end{consequence}
    \begin{consequence}
        Если прямая параллельна каждой из двух пересекающихся плоскостей,
    то она параллельна их линии пересечения.
    \end{consequence}
    \begin{definition}
        Углом между скрещивающимися прямыми называется угол между пересекающимися прямыми, параллельными данным и лежащим в одной плоскости.
    \end{definition}

    \setcounter{subsection}{4}
    \setcounter{consequence}{0}
    
    \subsection{Параллельность плоскостей}
    
    \begin{definition}
        Две плоскости называются параллельными, если они не имеют общих точек.
    \end{definition}
    
    \begin{theorem}[Признак параллельности плоскостей]
        Если две пересекающиеся прямые одной плоскости параллельны соответственно двум прямым другой плоскости, то эти плоскости параллельны:
        $$a,\,b\subset\alpha,\,a\cap b\neq\varnothing;\,\,c,\,d\subset\beta;\,\,a\parallel c,\,b\parallel d\Longrightarrow \alpha\parallel\beta$$
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(30:5mm)}]
                \begin{scope}[canvas is zx plane at y=2]
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                    \draw (1,-3) -- (6,3);
                    \draw (0,2) -- (8,-3);
                    \draw (2,-0.8) node[left] {$a$};
                    \draw (1.3,2) node {$b$};
                    \draw (9,-0.5) node {$\alpha$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \draw[opacity=0.2] (0,-3) grid (8,3);
                    \draw (1,-3) -- (6,3);
                    \draw (0,2) -- (8,-3);
                    \draw (2,-0.8) node[left] {$c$};
                    \draw (1.3,2) node {$d$};
                    \draw (9,-0.5) node {$\beta$};
                \end{scope}
                \foreach \point in {}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        Пусть $\alpha\cap\beta\neq\varnothing$. Тогда по теореме о линии пересечения плоскостей $\alpha\cap\beta=k,\,k\parallel a\,\,(c\subset\beta);\,\,\alpha\cap\beta=l,\,l\parallel b\,\,(d\subset\beta).$ Противоречие. 
    \end{proof}
    
    \begin{theorem}
        Линии пересечения двух параллельных плоскостей третьей плоскостью параллельны:
        $$\alpha\parallel\beta,\,\gamma\cap\alpha=a,\,\gamma\cap\beta=b\Longrightarrow a\parallel b$$
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(30:5mm)}]
                \begin{scope}[canvas is zx plane at y=2]
                    \draw[opacity=0.2] (0,-3) grid (7,3);
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \draw[opacity=0.2] (0,-3) grid (7,3);
                \end{scope}
                \begin{scope}[canvas is plane={O(0,0,3)x(1,0,3)y(0,1,3.5)}]
                    \fill[color=white] (-3,-1) rectangle (3,3);
                    \draw[opacity=0.2] (-3,-1) grid (3,3);
                \end{scope}
                \begin{scope}[canvas is zx plane at y=2]
                    \fill[color=white] (4,-3) rectangle (7,3);
                    \draw[opacity=0.2] (4,-3) grid (7,3);
                    \draw (4,-3) -- (4,3);
                    \draw (4,0) node[above] {$a$};
                    \draw (1,-3) -- (1,3);
                    \draw (1,0) node[above] {$c$};
                    \draw (8,-0.5) node {$\alpha$};
                    \draw (4.5,3.3) node[above] {$\gamma$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=0]
                    \fill[color=white] (3,-3) rectangle (7,3);
                    \draw[opacity=0.2] (3,-3) grid (7,3);
                    \draw (3,-3) -- (3,3);
                    \draw (3,0) node[above] {$b$};
                    \draw (8,-0.5) node {$\beta$};
                \end{scope}
                \foreach \point in {}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        \begin{center}
            $\alpha\parallel\beta\Longrightarrow\exists\,c\subset\alpha:\,\,c\parallel b.$ По теореме о крыше $a\parallel c,\,b\parallel c.$
        \end{center}
    \end{proof}

    \subsection{Сечения}

    \begin{definition}
        Если пересечение плоскости и многогранника есть многоугольник, то он называется сечением этого многогранника этой плоскостью.
    \end{definition}
    \begin{definition}
        Следом называется прямая, по которой плоскость сечения пересекает плоскость любой из граней многогранника.
    \end{definition}
    \begin{definition}
        Пирамида – это многогранник, одна из граней которого – произвольный многоугольник, а остальные грани – треугольники с общей вершиной.
    \end{definition}
    \begin{definition}
        Пирамида называется правильной, если в её основании лежит правильный многоугольник, а все боковые грани – равнобедренные треугольники с общей вершиной.
    \end{definition}
    \begin{definition}
        Высота боковой грани правильной пирамиды, проведённая из её вершины, называется апофемой этой пирамиды.
    \end{definition}
    \begin{definition}
        Треугольная пирамида называется тетраэдром.
    \end{definition}
    \begin{definition}
        Тетраэдр называется правильным, если все его рёбра равны.
    \end{definition}
    \begin{definition}
        Усечённой пирамидой называется часть пирамиды, заключённая между плоскостью основания и плоскостью, параллельной плоскости основания и пересекающей все боковые рёбра пирамиды.
    \end{definition}
    \begin{definition}
        Призма – это многогранник, две грани которого – равные многоугольники, лежащие в параллельных плоскостях, а все рёбра, не лежащие в этих плоскостях, параллельны между собой. Два равных многоугольника, лежащие в параллельных плоскостях, называются основаниями призмы. Остальные грани призмы называются её боковыми гранями, а их объединение \textendash\, боковой поверхностью призмы. Рёбра, не лежащие в основании призмы, называются её боковыми рёбрами. Если в основаниях призмы лежат $n$-угольники, то призма называется $n$-угольной.
    \end{definition}
    \begin{definition}
        Призма, основания которой являются параллелограммами, называется параллелепипедом.
    \end{definition}
    \begin{definition}
        Если все грани параллелепипеда являются прямоугольниками, то параллелепипед называется прямоугольным.
    \end{definition}
    \begin{definition}
        Если все грани параллелепипеда – квадраты, то он называется кубом.
    \end{definition}
    
    
    \subsection{Векторы в пространстве}
    
    \begin{definition}
        Векторы $\vec{v}$ и $\vec{u}$ называются коллинеарными, если $\exists\,\lambda:\,\vec{v}=\lambda\cdot\vec{u}$.
    \end{definition}
    \begin{theorem}[Признак копланарности векторов]
        Векторы $\vec{a}$, $\vec{b}$ и $\vec{c}$ называются копланарными, если $\exists\,\alpha,\,\beta:\,\vec{c}=\alpha\cdot\vec{a}+\beta\cdot\vec{b}$.
    \end{theorem}
    \begin{definition}
        Набор $\vec{a_1},\,\vec{a_2},\ldots,\,\vec{a_n}$ векторов линейно независим, если уравнение $\lambda_1\vec{a_1}+\lambda_2\vec{a_2}+\ldots+\lambda_n\vec{a_n}=0$ имеет только тривиальное решение, то есть $\lambda_1=\lambda_2=\ldots=\lambda_n=0$.
    \end{definition}
    \begin{definition}
        Базисом в $\R^n$ называется набор из $n$ линейно независимых векторов.
    \end{definition}
    \begin{definition}
        Коэффициенты $\alpha$, $\beta$ и $\gamma$ в разложении $\vec{v}=\alpha\cdot\vec{a}+\beta\cdot\vec{b}+\gamma\cdot\vec{c}$ называют координатами вектора $\vec{v}$ в базисе $\{\vec{a};\,\vec{b},\,\vec{c}\}$.
    \end{definition}
    \begin{theorem}
        Точка $M$ принадлежит плоскости $(ABC)$ тогда и только тогда, когда:
        $$\forall\,O\notin(ABC):\,\overrightarrow{OM}=x\cdot\overrightarrow{OA}+y\cdot\overrightarrow{OB}+z\cdot\overrightarrow{OC}\Longleftrightarrow x+y+z=1$$
    \end{theorem}
    
    \subsection{Перпендикулярность в пространстве}
    
    \begin{definition}
        Прямая перпендикулярна плоскости, если она перпендикулярна любой прямой, лежащей в этой плоскости.
    \end{definition}
    \begin{theorem}[Признак перпендикулярности прямой и плоскости]
        Прямая перпендикулярна плоскости, если она перпендикулярна двум пересекающимся прямым, лежащим в этой плоскости.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
            \begin{center}
                \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                    \begin{scope}[canvas is zy plane at x=0,fill=blue]
                        \coordinate (A) at (6,0);
                        \draw (6, 2) -- (A);
                        \draw[dashed] (A) -- (6, -0.97);
                        \draw (6, -0.97) -- (6, -1.5);
                        \draw (6,0.7) node[right] {$c$};
                    \end{scope}
                    \begin{scope}[canvas is zx plane at y=0,fill=red]
                        \coordinate (B) at (2, 0);
                        \draw[-{Stealth[scale = 1.5]}] (2,0) -- (4, 2);
                        \draw[-{Stealth[scale = 1.5]}] (2,0) -- (5, -2);
                        \draw[dashed] ($(2,0)!-1!(4,2)$) -- ($(2,0)!1.5!(4,2)$);
                        \draw[dashed] ($(2,0)!-0.67!(5,-2)$) -- ($(2,0)!1.5!(5,-2)$);
                        \draw ($(2,0)!0.25!(4,2)$) node[above] {$a$};
                        \draw ($(2,0)!0.415!(5,-2)$) node[below left] {$b$};
                        \draw[opacity=0.2] (0,-3) grid (8,3);
                    \end{scope}
                    \foreach \point in {(A), (B)}{
            \fill \point circle (1.8pt);
        }
                  \end{tikzpicture}
            \end{center}
            Пусть $\vec{v_a}$, $\vec{v_b}$ и $\vec{v_c}$ – направляющие векторы прямых $a$, $b$ и $c$ соответственно, тогда $\forall\,l\in\alpha:\,\vec{v_l}$ – направляющий $\vec{v_l}=x\vec{v_a}+y\vec{v_b}$, так как $a\cap b\neq\varnothing$. Тогда $\vec{v_c}\cdot\vec{v_l}=\vec{v_c}\cdot(x\vec{v_a}+y\vec{v_b})=0\Longrightarrow l\perp c$.
    \end{proof}
    \begin{theorem}
        Если одна из двух параллельных прямых перпендикулярна некоторой плоскости, то и вторая перпендикулярна этой плоскости.
    \end{theorem}
    \begin{theorem}
        Если две плоскости перпендикулярны одной и той же прямой, то они параллельны.
    \end{theorem}
    \begin{definition}
        Параллельное проектирование, при котором направление проектирования перпендикулярно плоскости проектирования, называют ортогональным проектированием.
    \end{definition}
    \begin{theorem}[О трёх перпендикулярах]
        Прямая, лежащая в плоскости, перпендикулярна наклонной тогда и только тогда, когда перпендикулярна проекции этой наклонной на эту плоскость.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
            \begin{center}
                \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                    \begin{scope}[canvas is zy plane at x=0,fill=blue]
                        \coordinate (A) at (4,0);
                        \coordinate (B) at (1,2);
                        \draw (B) -- (A);
                        \draw[dashed] (B) -- ($(B)!1.48!(A)$);
                        \draw ($(B)!1.48!(A)$) -- ($(B)!1.9!(A)$);
                        \draw ($(B)!0.5!(A)$) node[above right] {$a$};
                    \end{scope}
                    \begin{scope}[canvas is zx plane at y=0,fill=red]
                        \draw (0,0) -- (8,0);
                        \draw (4,3) -- (4,-3);
                        \draw (2,0) node[above] {$b$};
                        \draw (4.3,2) node[right] {$l$};
                        \draw (4,0) node[above] {$A$};
                        \draw (4.5,0) -- (4.5,-.7) -- (4,-.7);
                        \draw[opacity=0.2] (0,-3) grid (8,3);
                        \draw (8.5,-0.5) node {$\alpha$};
                    \end{scope}
                    \draw (0,0,4) -- (0,0.33,3.505) -- (-.7,0.33,3.505) -- (-.7,0,4);
                    \foreach \point in {(A)}{
            \fill \point circle (1.8pt);
        }
                  \end{tikzpicture}
            \end{center}
            Пусть $a$, $b$ и $l$ – это наклонная, её проекция и прямая, лежащая в плоскости $\alpha$ соответственно, также пусть $a\cap\alpha=A$. По лемме \ref{Пересекающиеся прямые и плоскость} существует плоскость $\beta$, содержащая $a$ и $b$. Тогда $\alpha\cap\beta=b$, причем должна существовать такая $d\subset\beta$, что она проходит через $a$ и $b$ и перпендикулярна $b$, а значит перпендикулярна $\alpha$. Отсюда она также перпендикулярна $l$ по признаку перпендикулярности, откуда $l\perp b$ по определению.
    \end{proof}
    \begin{definition}
        Углом между наклонной и плоскостью называется угол между наклонной и её проекцией на данную плоскость. 
    \end{definition}
    \begin{theorem}
        Угол между наклонной к плоскости и её проекцией на эту плоскость есть наименьший из углов между наклонной и каждой прямой, лежащей в этой плоскости.
    \end{theorem}
    \begin{theorem}
        Пусть прямая $a$ образует с плоскостью $\pi$ угол $\alpha$. Прямая $b\subset\pi$ образует с прямой $a$ угол $\varphi$, а с её проекцией на плоскость $\pi$ – угол $\beta$. Тогда $\cos\varphi=\cos\alpha\cdot\cos\beta$.
    \end{theorem}
    \begin{proof}
        $ $\par\nobreak\ignorespaces
            \begin{center}
                \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                    \begin{scope}[canvas is zx plane at y=0,fill=red]
                        \draw[opacity=0.2] (0,-3) grid (8,3);
                        \draw (8.5,-0.5) node {$\pi$};
                    \end{scope}
                    \coordinate (O) at (-1,0,2);
                    \coordinate (A) at (2,2,5);
                    \coordinate (L) at (2,0,5);
                    \coordinate (B) at (-1,0,5);
                    \draw ($(A)!-0.1!(O)$) -- (O);
                    \draw[dashed] (O) -- ($(A)!1.215!(O)$);
                    \draw ($(A)!1.215!(O)$) -- ($(A)!1.5!(O)$);
                    \draw ($(O)!-0.66!(L)$) -- ($(O)!1.33!(L)$);
                    \tkzMarkAngle[size=1.35cm](L,O,A);
                    \tkzMarkAngle[size=1.25cm](L,O,A);
                    \tkzMarkAngle[size=1.15cm](L,O,A);
                    \tkzMarkAngle[size=1.65cm](B,O,L);
                    \tkzMarkAngle[size=1.55cm](B,O,L);
                    \tkzMarkAngle[size=0.45cm](B,O,A);
                    \draw (0,0.4,3.2) node {$\alpha$};
                    \draw (-0.9,0.2,3.9) node {$\beta$};
                    \draw (-1,0.2,2.8) node {$\varphi$};
                    \draw (-1,0,0) -- (-1,0,8);
                    \draw (A) -- (L) -- (B);
                    \draw (B) ++(0.5,0,0) -- ++(0,0,0.5) -- ++(-0.5,0,0);
                    \draw (L) ++(0,0.3,0) -- ++(-0.21,0,-0.21) -- ++(0,-0.3,0);
                    \draw (A) node[above left] {$A$};
                    \draw (O) node[above] {$O$};
                    \draw (B) node[below] {$B$};
                    \draw (L) node[below right] {$L$};
                    \draw ($(A)!.5!(O)$) node[above left] {$a$};
                    \draw ($(O)!.65!(L)$) node[above] {$l$};
                    \draw ($(B)!-0.5!(O)$) node[below] {$b$};
                    \foreach \point in {(A),(B),(O),(L)}{
            \fill \point circle (1.8pt);
        }
                  \end{tikzpicture}
            \end{center}
            Пусть $A$ – произвольная точка на прямой $a$, $O$ – точка пересечения прямой $a$ с $\pi$, $L$ – основание перпендикуляра из $A$ на $\pi$, а $B$ – основание перпендикуляра из $L$ на $b$. Без ограничения общности положим $OA=1$, тогда $OL=\cos\alpha$, а $OB=\cos\alpha\cdot\cos\beta$. Пусть $\delta=(ABL)$, тогда $BL\perp b$ по построению, $AL\perp b$, так как $b\subset\pi$, $AL\perp\pi\Longrightarrow b\perp\delta\Longrightarrow b\perp AB$. Отсюда $OB=\cos\varphi=\cos\alpha\cdot\cos\beta$.
    \end{proof}
    \begin{definition}
        Если среди всех расстояний между точками, одна из которых принадлежит фигуре $\Phi_1$, а другая – фигуре $\Phi_2$, существует наименьшее, то его называют между фигурами $\Phi_1$ и $\Phi_2$.
    \end{definition}
    \begin{theorem}
        Расстоянием от точки до плоскости является расстояние от данной точки до её проекции на данную плоскость.
    \end{theorem}
    \begin{definition}
        Общим перпендикуляром двух скрещивающихся прямых называется отрезок, концы которого лежат на данных прямых, перпендикулярный к ним.
    \end{definition}
    \begin{theorem}
        Общий перпендикуляр двух скрещивающихся прямых существует и единственен.
    \end{theorem}
    \begin{theorem}
        Расстояние между двумя скрещивающимися прямыми равно расстоянию от точки пересечения одной из этих прямых с перпендикулярной ей плоскостью до проекции другой прямой на эту плоскость.
    \end{theorem}
    \subsection{Двугранные углы}

\begin{definition}
    Две полуплоскости с общей ограничивающей их прямой разбивают пространство на два двугранных угла. Полуплоскости называются гранями этого угла, а их общая прямая – его ребром.
\end{definition}
\begin{definition}
    Линейным углом двугранного угла называется пересечение данного двугранного угла с плоскостью, перпендикулярной его ребру.
\end{definition}
\begin{definition}
    Величиной двугранного угла называется величина его линейного угла.
\end{definition}
\begin{theorem}
    Величина двугранного угла не зависит от выбора его линейного угла.
\end{theorem}
\begin{definition}
    Полуплоскость, границей которой является ребро двугранного угла, делящая его на два равных по величине двугранных угла называется биссектором данного угла.
\end{definition}
\begin{definition}
    Углом между плоскостями называется наименьший из образованных их пересечением двугранных углов. Угол между параллельными плоскостями полагается равным нулю.
\end{definition}
\begin{definition}
    Плоскости называются перпендикулярными, если угол между ними равен $90^\circ$.
\end{definition}
\begin{theorem}[Признак перпендикулярности плоскостей] Если плоскость содержит прямую, перпендикулярную другой плоскости, то данные плоскости перпендикулярны.
\end{theorem}
\begin{proof}
    $ $\par\nobreak\ignorespaces
        \begin{center}
            \begin{tikzpicture}[z={(0:10mm)},x={(40:5mm)}]
                \begin{scope}[canvas is zx plane at y=3,fill=red]
                    \draw[opacity=0.2] (0,0) grid (4,6);
                    \draw (0,3) -- (4,3);
                    \draw (2,-1) node {$\alpha$};
                \end{scope}
                \begin{scope}[canvas is yx plane at z=4,fill=blue]
                    \coordinate (O) at (3,3);
                    \fill[white] (0,0) rectangle (6,6);
                    \draw[opacity=0.2] (0,0) grid (6,6);
                    \draw (0,3) -- (6,3);
                    \draw (4.5,3) node[right] {$l$};
                    \draw (4.5,6) node[right] {$\beta$};
                \end{scope}
                \begin{scope}[canvas is zx plane at y=3,fill=red]
                    \fill[white] (4,0) rectangle (8,6);
                    \draw[opacity=0.2] (4,0) grid (8,6);
                    \draw (4,3) -- (8,3);
                    \draw (6,3) node[below] {$m$};
                    \draw[dashed] (3,3) -- (4,3);
                    \draw (4.5,1) node {$k$};
                    \draw (4,3) -- ++(0.5,0) -- ++(0,-0.5) -- ++(-0.5,0);
                \end{scope}
                \begin{scope}[canvas is yx plane at z=4,fill=blue]
                    \draw (3,3) node[above left] {$O$};
                    \draw (3,3) -- ++(0.5,0) -- ++(0,0.5) -- ++(-0.5,0);
                    \draw[dashed] (2,3) -- (3,3);
                    \draw (3,0) -- (3,6);
                \end{scope}
                \foreach \point in {(O)}{
        \fill \point circle (1.8pt);
    }
              \end{tikzpicture}
        \end{center}
        Пусть $l\perp\alpha$, тогда $\forall m\subset\alpha:\,\,l\perp m$. Пусть $\alpha\cap\beta=k$. Пусть также $m\perp k;\,\,m\cap k=O.$ Тогда $\angle(m;\,l)$ – линейный угол одного из двугранных углов между $\alpha$ и $\beta$. $m\perp k;\,l\perp k;\,m\cap l=O\in k$, значит $\angle(m;\,l)=90^\circ$.
\end{proof}

\begin{theorem}[Площадь ортогональной проекции многоугольника]
    Площадь ортогональной проекции многоугольника равна произведению площади данного многоугольника и косинуса угла между плоскостью проецирования и плоскостью многоугольника.
\end{theorem}

\begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[z={(0:10mm)},x={(25:5mm)},y={(110:7mm)}]
            \begin{scope}[canvas is zx plane at y=0]
                \coordinate (A1) at (1,1);
                \coordinate (B1) at (7,1);
                \coordinate (C1) at (5,-2);
                \coordinate (H1) at (5,1);
                \draw[opacity=0.2] (0,-3) grid (8,3);
                \draw (1,3) -- ++(0,-0.5) -- ++(0.5,0) -- ++(0,0.5);
                \draw (H1) -- ++(0,-0.5) -- ++(-0.5,0) -- ++(0,0.5);
                \draw (7,3) -- ++(0,-0.5) -- ++(0.5,0) -- ++(0,0.5);
                \draw (A1) -- (B1) -- (C1) -- cycle;
                \draw (0,3) -- (8,3);
                \draw (A1) node[above left] {$A'$};
                \draw (B1) node[above left] {$B'$};
                \draw (C1) node[above left] {$C'$};
                \draw (H1) node[above left] {$H'$};
                \draw (1.5,-1.5) node {$\alpha$};
            \end{scope}
            \begin{scope}[canvas is zy plane at x=3]
                \coordinate (A) at (1,2);
                \coordinate (B) at (7,2);
                \coordinate (C) at (5,5);
                \coordinate (M) at (1,0);
                \coordinate (N) at (7,0);
                \coordinate (H) at (5,2);
                \coordinate (K) at (5,0);
                \draw (M) -- ++(0,0.5) -- ++(-0.5,0) -- ++(0,-0.5);
                \draw (H) -- ++(0,0.5) -- ++(-0.5,0) -- ++(0,-0.5);
                \draw (N) -- ++(0,0.5) -- ++(-0.5,0) -- ++(0,-0.5);
                \draw[opacity=0.2] (0,0) grid (8,6);
                \draw (A) -- (B) -- (C) -- cycle;
                \draw (A) node[above left] {$A$};
                \draw (B) node[above right] {$B$};
                \draw (C) node[above left] {$C$};
                \draw (H) node[above right] {$H$};
                \draw (M) node[above right] {$M$};
                \draw (N) node[above right] {$N$};
                \draw (K) node[above left] {$K$};
                \draw (1.5,4.5) node {$\beta$};
                \draw (3,0) node[above left] {$l$};
            \end{scope}
            \draw[dashed] (1,0,1) -- (3,2,1) -- (3,0,1) -- cycle;
            \draw[dashed] (1,0,7) -- (3,2,7) -- (3,0,7) -- cycle;
            \draw[dashed] (1,0,5) -- (3,2,5);
            \draw (-2,0,5) -- (3,0,5) -- (3,5,5);
            \draw[dashed] (-2,0,5) -- (3,5,5);
            \foreach \point in {(A), (B), (C), (A1), (B1), (C1), (H), (H1), (K), (N), (M)}{
    \fill \point circle (1.8pt);
}
          \end{tikzpicture}
    \end{center}
    Пусть $\triangle ABC\subset\beta;\,l=\alpha\cap\beta;\,AB\,\|\,l$. Обозначим $H$ основание высоты $CH$ треугольника $ABC$, $M$ – проекция $A$ на $l$, $N$ – проекция $B$ на $l$, а $A',\,B',\,C',\,H'$ – проекции $A,\,B,\,C,\,H$ на $\alpha$ соответственно. Тогда $MABN$ – прямоугольник, значит по теореме о трёх перпендикулярах $MA'\perp l;\,NB'\perp l$, то есть $MA'B'N$ – прямоугольник, а значит $AB=MN=A'B'$. $S_{\triangle ABC}=\frac{1}{2}AB\cdot CH;\,S_{\triangle A'B'C'}=\frac{1}{2}A'B'\cdot C'H'=\frac{1}{2}AB\cdot C'H'$. Пусть $K$ – проекция $C$ на $l$, тогда $H'\in C'K$. Пусть $\angle CKC'=\theta$, значит $KC'=KC\cdot\cos\theta;\,KH'=KH\cdot\cos\theta\Longrightarrow C'H'=CH\cdot\cos\theta$. То есть $S_{\triangle A'B'C'}=\frac{1}{2}AB\cdot C'H'=S_{\triangle ABC}\cdot\cos\theta$.\bigskip

    Теорема доказана для треугольника, одна из сторон которого параллельна ребру двугранного угла. Чтобы обобщить доказательство до произвольного треугольника, достаточно заметить, что мы можем провести прямую, параллельную ребру двугранного угла, через одну из вершин этого треугольника, разбив его на два треугольника, удовлетворяющих нашему условию. Для произвольного многоугольника достаточно сказать, что его можно разбить на треугольники, а значит теорема доказана.
\end{proof}

\subsection{Многогранные углы}

\begin{definition}
    Пусть $\Phi=A_1A_2\ldots A_n$ \textemdash\, $n$-угольник; $n\geq3$; точка $S\notin (A_1A_2A_3)$, тогда часть пространства, ограниченная гранями $SA_1A_2,\,SA_2A_3,\ldots,\,SA_nA_1$ называется многогранным углом. 
\end{definition}
\begin{definition}
    Пусть $\Phi=A_1A_2\ldots A_n$ \textemdash\, $n$-угольник; $n\geq3$; точка $S\notin (A_1A_2A_3)$, тогда многогранным углом называется множество лучей $SX\,\forall\,X\in\Phi$.
\end{definition}
\begin{theorem}[Первая теорема косинусов]
    $$\cos\angle C=\frac{\cos\gamma-\cos\alpha\cdot\cos\beta}{\sin\alpha\cdot\sin\beta}$$
\end{theorem}
\begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[3d view={35}{25}]
            \begin{scope}[canvas is xz plane at y=0]
                \coordinate (O) at (180:3.5);
                \coordinate (C) at (100:3.5);
                \coordinate (A) at (0:3.5);
                \draw (O) -- (A) -- (C) -- cycle;
            \end{scope}
            \coordinate (B) at (1,3,0);
            \draw (A) -- (B) -- (C);
            \draw[dashed] (O) -- (B);
            \tkzMarkRightAngle(A,C,O);
            \tkzMarkRightAngle(B,C,O);
            \draw (O) node[left] {$O$};
            \draw (A) node[below right] {$A$};
            \draw (B) node[above right] {$B$};
            \draw (C) node[above] {$C$};
            \tkzMarkAngle[size=0.35cm](B,O,C);
            \draw (-3.15,0.4,0.2) node {$\alpha$};
            \tkzMarkAngle[size=1.25cm](A,O,B);
            \tkzMarkAngle[size=1.35cm](A,O,B);
            \tkzMarkAngle[size=1.45cm](A,O,B);
            \draw (-1.7,0.4,0) node {$\gamma$};
            \tkzMarkAngle[size=0.9cm](A,O,C);
            \tkzMarkAngle[size=1cm](A,O,C);
            \draw (-2,0,0.8) node {$\beta$};
            \foreach \point in {(O), (A), (B), (C)}{
    \fill \point circle (1.8pt);
}
          \end{tikzpicture}
    \end{center}
    Пусть $A$ и $B$ – такие точки на рёбрах угла, что $AC\perp OC$ и $BC\perp OC$. Тогда $\angle BCA$ – линейный угол $\angle C$. Из $\triangle OCA$ и $\triangle OCB$:
    $$OA=\frac{OC}{\cos\beta};\,OB=\frac{OC}{\cos\alpha}\Longrightarrow AC=OC\cdot\tg \beta;\,BC=OC\cdot\tg \alpha$$
    По теореме косинусов в $\triangle OBA$ и $\triangle ABC$:
    $$AB^2=OC^2\cdot\left(\frac{1}{\cos^2\beta}+\frac{1}{\cos^2\alpha}-\frac{2\cos\gamma}{\cos\alpha\cdot\cos\beta}\right)=OC^2\cdot\left(\tg^2 \beta+\tg^2 \alpha -2\tg \beta \cdot \tg \alpha \cdot\cos \angle C\right)$$
    Тогда если выразить $\cos\angle C$ получим:
    $$\cos\angle C=\frac{\cos\gamma-\cos\alpha\cdot\cos\beta}{\sin\alpha\cdot\sin\beta}$$
\end{proof}
\begin{theorem}[Вторая теорема косинусов]
    $$\cos\angle C=-\cos\angle A\cdot\cos\angle B+\sin\angle A\cdot\sin \angle B\cdot\cos\gamma$$
\end{theorem}
\begin{theorem}[Теорема синусов]
    $$\frac{\sin\alpha}{\sin\angle A}=\frac{\sin\beta}{\sin\angle B}=\frac{\sin\gamma}{\sin\angle C}$$
\end{theorem}
\begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[3d view={25}{25}]
            \coordinate (O) at (0,0,0);
            \coordinate (A) at (7,0,0);
            \coordinate (B) at (5,4,0);
            \coordinate (C) at (4,2,3);
            \coordinate (H) at (4,2,0);
            \coordinate (K) at (3.41,2.73,0);
            \coordinate (L) at (4,0,0);
            \draw (O) -- (A) -- (C) -- cycle;
            \draw (A) -- (B) -- (C);
            \draw[dashed] (O) -- (B);
            \draw[dashed] (C) -- (K) -- (H) -- cycle;
            \draw[dashed] (H) -- (L);
            \draw (C) -- (L);
            \draw (O) node[left] {$O$};
            \draw (A) node[below right] {$A$};
            \draw (B) node[above right] {$B$};
            \draw (C) node[above] {$C$};
            \draw (H) node[below right] {$H$};
            \draw (K) node[above right] {$K$};
            \draw (L) node[below left] {$L$};
            \tkzMarkRightAngle(H,K,B);
            \tkzMarkRightAngle(C,K,O);
            \tkzMarkRightAngle(H,L,A);
            \tkzMarkRightAngle(C,L,O);
            \tkzMarkAngle[size=0.35cm](B,O,C);
            \draw (0.6,0.4,0.2) node {$\alpha$};
            \tkzMarkAngle[size=1cm](A,O,C);
            \tkzMarkAngle[size=1.1cm](A,O,C);
            \draw (1.5,0,0.5) node {$\beta$};
            \foreach \point in {(O), (A), (B), (C), (H), (K), (L)}{
    \fill \point circle (1.8pt);
}
          \end{tikzpicture}
    \end{center}
    Пусть $H$ – проекция $C$ на $(ABC)$, $K$ – проекция $C$ на $OB$ и $L$ – проекция $C$ на $OA$ соответственно. По теореме о трёх перпендикулярах $HK\perp OB$ и $HL\perp OA$. Тогда из $\triangle OCK$ и $\triangle CKH$:  $CH=OC\cdot\sin\alpha\cdot\sin\angle B$. Аналогично из $\triangle OCL$ и $\triangle CLH$: $CH=OC\cdot\sin\beta\cdot\sin\angle A$. То есть:
    $$\frac{\sin\alpha}{\sin \angle A}=\frac{\sin\beta}{\sin \angle B}$$
\end{proof}
\begin{theorem}[Теорема о трёх синусах]
    Пусть прямая $l$ содержится в одной из граней двугранного угла. Также пусть $\alpha$ – плоский угол данного двугранного угла, $\beta$ – угол между прямой и ребром двугранного угла, а $\gamma$ – угол между $l$ и её проекцией на вторую грань угла. Тогда:
    $$\sin\gamma=\sin\alpha\cdot\sin\beta$$
\end{theorem}
\begin{proof}
    $ $\par\nobreak\ignorespaces
    \begin{center}
        \begin{tikzpicture}[3d view={15}{15}]
            \begin{scope}[canvas is xy plane at z=0]
                \draw[opacity=0.3] (0,0) grid (8,-6);
                \coordinate (C) at (7,-5);
            \end{scope}
            \begin{scope}[canvas is plane={O(0,0,0)x(1,0,0)y(0,-1,1)}]
                \draw[opacity=0.3] (0,0) grid (8,6);
                \coordinate (A) at (7,5);
                \coordinate (B) at (7,0);
                \coordinate (O) at (1,0);
                \draw (4,3) node {$l$};
            \end{scope}
            \draw (A) -- (B) -- (C) -- cycle;
            \draw (O) -- (C) -- (A) -- cycle;
            \tkzMarkRightAngle(A,C,B);
            \tkzMarkRightAngle(A,C,O);
            \draw (O) node[above left] {$O$};
            \draw (A) node[above left] {$A$};
            \draw (B) node[above right] {$B$};
            \draw (C) node[below left] {$C$};
            \tkzMarkAngle[size=0.45cm](A,B,C);
            \draw (6.7,-2,0.6) node {$\alpha$};
            \tkzMarkAngle[size=0.55cm](B,O,A);
            \tkzMarkAngle[size=0.65cm](B,O,A);
            \draw (2,0,0.3) node {$\beta$};
            \tkzMarkAngle[size=1.4cm](C,O,A);
            \tkzMarkAngle[size=1.5cm](C,O,A);
            \tkzMarkAngle[size=1.6cm](C,O,A);
            \draw (3.3,-1,0.8) node {$\gamma$};
            \foreach \point in {(A), (B), (C), (O)}{
    \fill \point circle (1.8pt);
}
            \end{tikzpicture}
    \end{center}
    Пусть $l$ пересекает ребро двугранного угла в точке $O$. Возьмём произвольную точку $A$ на этой прямой. Пусть $C$ – основание перпендикуляра из $A$ на вторую грань двугранного угла, а $B$ – проекция $A$ на ребро двугранного угла. Тогда по теореме о трёх перпендикулярах $CB\perp OB$, а значит $\angle ABC=\alpha$. Тогда:
    $$\sin\gamma=\frac{AC}{OA}=\frac{AB\cdot\sin\alpha}{OA}=\frac{OA\cdot\sin\beta\cdot\sin\alpha}{OA}=\sin\alpha\cdot\sin\beta$$
\end{proof}

\subsection{Тела вращения}

\begin{definition}
  Фигура называется фигурой вращения, если в пространстве существует такая ось, что при любом повороте вокруг этой оси фигура переходит в себя.
\end{definition}
\begin{definition}
  Сфера суть ГМТ пространства, равноудалённых от данной точки, называемой центром.
\end{definition}
\begin{definition}
  Шар суть ГМТ пространства, удалённых не более чем на фиксированное расстояние от данной точки, называемой центром.
\end{definition}
\begin{definition}
  Плоскость называется касательной к сфере (шару), если она имеет с ней (с ним) ровно одну общую точку.
\end{definition}
\begin{statement}[Объём шара]
  Пусть $R$ – радиус шара, тогда объём шара равен:
  $$V=\frac{4}{3}\pi R^3$$
\end{statement}
\begin{proof}
  $$V=2\int_{0}^{R}\pi\left(R^2-(R-r)^2\right)\diff r=4\pi r\int_{0}^{R}\diff r-2\pi\int_{0}^{R}r^2\diff r=4\pi R\cdot \frac{R^2}{2} - 2\pi\cdot \frac{R^3}{3}=\frac{4}{3}\pi R^3$$
\end{proof}
\begin{definition}
  Пусть в одной плоскости даны прямая $l$ и круг $S$, не имеющие общих точек, тогда тело, полученное вращением плоскости относительно $l$ называется тором.
\end{definition}
\begin{statement}[Объём тора]
  Пусть $R$ – радиус круга, образованного осевым сечением тора, $d$ – расстояние от оси тора до центра данного круга. Тогда объём тора равен:
  $$V=2\pi^2 d R^2$$
\end{statement}
\begin{proof}
  Уравнение окружности имеет вид $(x-d)^2 + y^2=R^2$, откуда $x=d\pm \sqrt{R^2-y^2}$. Пусть $x_1=d-\sqrt{R^2-y^2}$, $x_2=d+\sqrt{R^2-y^2}$. Тогда:
  $$V=\int_{-R}^{R}(\pi x_2^2-\pi x_1^2)\diff y=\pi\int_{-R}^{R}2d\cdot2\sqrt{R^2-y^2}\cdot \diff y=4\pi d\int_{-R}^{R}\sqrt{R^2-y^2}\cdot \diff y=2\pi^2 d R^2$$
\end{proof}
\begin{definition}
  Пусть в пространстве даны плоскость $\alpha$, содержащаяся в ней кривая $\gamma$ и прямая $l$, пересекающая данную плоскость. Тогда множество прямых, параллельных $l$ и пересекающих $\gamma$, называется цилиндрической поверхностью.
\end{definition}
\begin{definition}
  Цилиндром называется тело, ограниченное замкнутой цилиндрической поверхностью и двумя параллельными плоскостями.
\end{definition}
\begin{definition}
  Цилиндр называется прямым, если образующая его цилиндрическая плоскость перпендикулярная его основанию.
\end{definition}
\begin{definition}
  Цилиндр называется круговым, если его основания являются кругами.
\end{definition}
\begin{definition}
  Пусть в пространстве даны точка $S$, плоскость $\alpha$ и лежащая в ней кривая $\gamma$. Множество точек пространства называется конической поверхностью, если они принадлежат прямым, проходящим через $S$ и пересекающим $\gamma$. Точка $S$ называется её вершиной, $\gamma$ – её направляющей, а прямые, проходящие через вершину – образующими.
\end{definition}
\begin{definition}
  Конусом называется тело, ограниченное замкнутой конической поверхностью и плоскостью, пересекающей все образующие с одной стороны от $S$.
\end{definition}
\begin{definition}
  Конус называется круговым, если его основание является кругом.
\end{definition}
\begin{definition}
  Конус называется прямым, если его вершина ортогонально проецируется в центр основания.
\end{definition}
\begin{definition}
  Часть конуса, заключённая между его основанием и секущей плоскостью, параллельной основанию, называется усечённым конусом.
\end{definition}
\end{document}